var e={};!function(t,r){const n=r(t);"string"!=typeof e.nodeName?e=n:(t._hyperscript=n,"document"in t&&t._hyperscript.browserInit())}("undefined"!=typeof self?self:e,(e=>{const t={dynamicResolvers:[function(e,t){if("Fixed"===e)return Number(t).toFixed();if(0===e.indexOf("Fixed:")){let r=e.split(":")[1];return Number(t).toFixed(parseInt(r))}}],String:function(e){return e.toString?e.toString():""+e},Int:function(e){return parseInt(e)},Float:function(e){return parseFloat(e)},Number:function(e){return Number(e)},Date:function(e){return new Date(e)},Array:function(e){return Array.from(e)},JSON:function(e){return JSON.stringify(e)},Object:function(e){return e instanceof String&&(e=e.toString()),"string"==typeof e?JSON.parse(e):Object.assign({},e)}},r={attributes:"_, script, data-script",defaultTransition:"all 500ms ease-in",disableSelector:"[disable-scripting], [data-disable-scripting]",hideShowStrategies:{},conversions:t};class n{static OP_TABLE={"+":"PLUS","-":"MINUS","*":"MULTIPLY","/":"DIVIDE",".":"PERIOD","..":"ELLIPSIS","\\":"BACKSLASH",":":"COLON","%":"PERCENT","|":"PIPE","!":"EXCLAMATION","?":"QUESTION","#":"POUND","&":"AMPERSAND",$:"DOLLAR",";":"SEMI",",":"COMMA","(":"L_PAREN",")":"R_PAREN","<":"L_ANG",">":"R_ANG","<=":"LTE_ANG",">=":"GTE_ANG","==":"EQ","===":"EQQ","!=":"NEQ","!==":"NEQQ","{":"L_BRACE","}":"R_BRACE","[":"L_BRACKET","]":"R_BRACKET","=":"EQUALS"};static isValidCSSClassChar(e){return n.isAlpha(e)||n.isNumeric(e)||"-"===e||"_"===e||":"===e}static isValidCSSIDChar(e){return n.isAlpha(e)||n.isNumeric(e)||"-"===e||"_"===e||":"===e}static isWhitespace(e){return" "===e||"\t"===e||n.isNewline(e)}static positionString(e){return"[Line: "+e.line+", Column: "+e.column+"]"}static isNewline(e){return"\r"===e||"\n"===e}static isNumeric(e){return e>="0"&&e<="9"}static isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}static isIdentifierChar(e,t){return"_"===e||"$"===e}static isReservedChar(e){return"`"===e||"^"===e}static isValidSingleQuoteStringStart(e){if(e.length>0){var t=e[e.length-1];if("IDENTIFIER"===t.type||"CLASS_REF"===t.type||"ID_REF"===t.type)return!1;if(t.op&&(">"===t.value||")"===t.value))return!1}return!0}static tokenize(e,t){var r=[],a=e,o=0,s=0,u=1,l="<START>",c=0;function m(){return t&&0===c}for(;o<a.length;)if("-"===S()&&"-"===q()&&(n.isWhitespace(N(2))||""===N(2)||"-"===N(2))||"/"===S()&&"/"===q()&&(n.isWhitespace(N(2))||""===N(2)||"/"===N(2)))p();else if("/"!==S()||"*"!==q()||!n.isWhitespace(N(2))&&""!==N(2)&&"*"!==N(2))if(n.isWhitespace(S()))r.push(C());else if(I()||"."!==S()||!n.isAlpha(q())&&"{"!==q()&&"-"!==q())if(I()||"#"!==S()||!n.isAlpha(q())&&"{"!==q())if("["===S()&&"@"===q())r.push(v());else if("@"===S())r.push(E());else if("*"===S()&&n.isAlpha(q()))r.push(T());else if(n.isAlpha(S())||!m()&&n.isIdentifierChar(S()))r.push(k());else if(n.isNumeric(S()))r.push(x());else if(m()||'"'!==S()&&"`"!==S())if(m()||"'"!==S()){if(n.OP_TABLE[S()])"$"===l&&"{"===S()&&c++,"}"===S()&&c--,r.push(g());else if(m()||n.isReservedChar(S()))r.push(f("RESERVED",w()));else if(o<a.length)throw Error("Unknown token: "+S()+" ")}else n.isValidSingleQuoteStringStart(r)?r.push(b()):r.push(g());else r.push(b());else r.push(y());else r.push(d());else h();return new i(r,[],a);function f(e,t){return{type:e,value:t||"",start:o,end:o+1,column:s,line:u}}function p(){for(;S()&&!n.isNewline(S());)w();w()}function h(){for(;S()&&("*"!==S()||"/"!==q());)w();w(),w()}function d(){var e=f("CLASS_REF"),t=w();if("{"===S()){for(e.template=!0,t+=w();S()&&"}"!==S();)t+=w();if("}"!==S())throw Error("Unterminated class reference");t+=w()}else for(;n.isValidCSSClassChar(S());)t+=w();return e.value=t,e.end=o,e}function v(){for(var e=f("ATTRIBUTE_REF"),t=w();o<a.length&&"]"!==S();)t+=w();return"]"===S()&&(t+=w()),e.value=t,e.end=o,e}function E(){for(var e=f("ATTRIBUTE_REF"),t=w();n.isValidCSSIDChar(S());)t+=w();if("="===S())if(t+=w(),'"'===S()||"'"===S()){t+=b().value}else if(n.isAlpha(S())||n.isNumeric(S())||n.isIdentifierChar(S())){t+=k().value}return e.value=t,e.end=o,e}function T(){for(var e=f("STYLE_REF"),t=w();n.isAlpha(S())||"-"===S();)t+=w();return e.value=t,e.end=o,e}function y(){var e=f("ID_REF"),t=w();if("{"===S()){for(e.template=!0,t+=w();S()&&"}"!==S();)t+=w();if("}"!==S())throw Error("Unterminated id reference");w()}else for(;n.isValidCSSIDChar(S());)t+=w();return e.value=t,e.end=o,e}function k(){for(var e=f("IDENTIFIER"),t=w();n.isAlpha(S())||n.isNumeric(S())||n.isIdentifierChar(S());)t+=w();return"!"===S()&&"beep"===t&&(t+=w()),e.value=t,e.end=o,e}function x(){for(var e=f("NUMBER"),t=w();n.isNumeric(S());)t+=w();for("."===S()&&n.isNumeric(q())&&(t+=w());n.isNumeric(S());)t+=w();for("e"!==S()&&"E"!==S()||(n.isNumeric(q())?t+=w():"-"===q()&&(t+=w(),t+=w()));n.isNumeric(S());)t+=w();return e.value=t,e.end=o,e}function g(){for(var e=function(e,t){var r=f(e,t);return r.op=!0,r}(),t=w();S()&&n.OP_TABLE[t+S()];)t+=w();return e.type=n.OP_TABLE[t],e.value=t,e.end=o,e}function b(){for(var e=f("STRING"),t=w(),r="";S()&&S()!==t;)if("\\"===S()){w();let e=w();r+="b"===e?"\b":"f"===e?"\f":"n"===e?"\n":"r"===e?"\r":"t"===e?"\t":"v"===e?"\v":e}else r+=w();if(S()!==t)throw Error("Unterminated string at "+n.positionString(e));return w(),e.value=r,e.end=o,e.template="`"===t,e}function S(){return a.charAt(o)}function q(){return a.charAt(o+1)}function N(e=1){return a.charAt(o+e)}function w(){return l=S(),o++,s++,l}function I(){return n.isAlpha(l)||n.isNumeric(l)||")"===l||'"'===l||"'"===l||"`"===l||"}"===l||"]"===l}function C(){for(var e=f("WHITESPACE"),t="";S()&&n.isWhitespace(S());)n.isNewline(S())&&(s=0,u++),t+=w();return e.value=t,e.end=o,e}}tokenize(e,t){return n.tokenize(e,t)}}class i{constructor(e,t,r){this.tokens=e,this.consumed=t,this.source=r,this.consumeWhitespace()}get list(){return this.tokens}_lastConsumed=null;consumeWhitespace(){for(;"WHITESPACE"===this.token(0,!0).type;)this.consumed.push(this.tokens.shift())}raiseError(e,t){a.raiseParseError(e,t)}requireOpToken(e){var t=this.matchOpToken(e);if(t)return t;this.raiseError(this,"Expected '"+e+"' but found '"+this.currentToken().value+"'")}matchAnyOpToken(e,t,r){for(var n=0;n<arguments.length;n++){var i=arguments[n],a=this.matchOpToken(i);if(a)return a}}matchAnyToken(e,t,r){for(var n=0;n<arguments.length;n++){var i=arguments[n],a=this.matchToken(i);if(a)return a}}matchOpToken(e){if(this.currentToken()&&this.currentToken().op&&this.currentToken().value===e)return this.consumeToken()}requireTokenType(e,t,r,n){var i=this.matchTokenType(e,t,r,n);if(i)return i;this.raiseError(this,"Expected one of "+JSON.stringify([e,t,r]))}matchTokenType(e,t,r,n){if(this.currentToken()&&this.currentToken().type&&[e,t,r,n].indexOf(this.currentToken().type)>=0)return this.consumeToken()}requireToken(e,t){var r=this.matchToken(e,t);if(r)return r;this.raiseError(this,"Expected '"+e+"' but found '"+this.currentToken().value+"'")}peekToken(e,t,r){return t=t||0,r=r||"IDENTIFIER",this.tokens[t]&&this.tokens[t].value===e&&this.tokens[t].type===r}matchToken(e,t){if(-1===this.follows.indexOf(e))return t=t||"IDENTIFIER",this.currentToken()&&this.currentToken().value===e&&this.currentToken().type===t?this.consumeToken():void 0}consumeToken(){var e=this.tokens.shift();return this.consumed.push(e),this._lastConsumed=e,this.consumeWhitespace(),e}consumeUntil(e,t){for(var r=[],n=this.token(0,!0);!(null!=t&&n.type===t||null!=e&&n.value===e||"EOF"===n.type);){var i=this.tokens.shift();this.consumed.push(i),r.push(n),n=this.token(0,!0)}return this.consumeWhitespace(),r}lastWhitespace(){return this.consumed[this.consumed.length-1]&&"WHITESPACE"===this.consumed[this.consumed.length-1].type?this.consumed[this.consumed.length-1].value:""}consumeUntilWhitespace(){return this.consumeUntil(null,"WHITESPACE")}hasMore(){return this.tokens.length>0}token(e,t){var r,n=0;do{if(!t)for(;this.tokens[n]&&"WHITESPACE"===this.tokens[n].type;)n++;r=this.tokens[n],e--,n++}while(e>-1);return r||{type:"EOF",value:"<<<EOF>>>"}}currentToken(){return this.token(0)}lastMatch(){return this._lastConsumed}static sourceFor=function(){return this.programSource.substring(this.startToken.start,this.endToken.end)};static lineFor=function(){return this.programSource.split("\n")[this.startToken.line-1]};follows=[];pushFollow(e){this.follows.push(e)}popFollow(){this.follows.pop()}clearFollows(){var e=this.follows;return this.follows=[],e}restoreFollows(e){this.follows=e}}class a{constructor(e){this.runtime=e,this.possessivesDisabled=!1,this.addGrammarElement("feature",(function(e,t,r){if(r.matchOpToken("(")){var n=e.requireElement("feature",r);return r.requireOpToken(")"),n}var i=e.FEATURES[r.currentToken().value||""];if(i)return i(e,t,r)})),this.addGrammarElement("command",(function(e,t,r){if(r.matchOpToken("(")){const t=e.requireElement("command",r);return r.requireOpToken(")"),t}var n=e.COMMANDS[r.currentToken().value||""];let i;return n?i=n(e,t,r):"IDENTIFIER"===r.currentToken().type&&(i=e.parseElement("pseudoCommand",r)),i?e.parseElement("indirectStatement",r,i):i})),this.addGrammarElement("commandList",(function(e,t,r){if(r.hasMore()){var n=e.parseElement("command",r);if(n){r.matchToken("then");const t=e.parseElement("commandList",r);return t&&(n.next=t),n}}return{type:"emptyCommandListCommand",op:function(e){return t.findNext(this,e)},execute:function(e){return t.unifiedExec(this,e)}}})),this.addGrammarElement("leaf",(function(e,t,r){var n=e.parseAnyOf(e.LEAF_EXPRESSIONS,r);return null==n?e.parseElement("symbol",r):n})),this.addGrammarElement("indirectExpression",(function(e,t,r,n){for(var i=0;i<e.INDIRECT_EXPRESSIONS.length;i++){var a=e.INDIRECT_EXPRESSIONS[i];n.endToken=r.lastMatch();var o=e.parseElement(a,r,n);if(o)return o}return n})),this.addGrammarElement("indirectStatement",(function(e,t,r,n){if(r.matchToken("unless")){n.endToken=r.lastMatch();var i={type:"unlessStatementModifier",args:[e.requireElement("expression",r)],op:function(e,t){return t?this.next:n},execute:function(e){return t.unifiedExec(this,e)}};return n.parent=i,i}return n})),this.addGrammarElement("primaryExpression",(function(e,t,r){var n=e.parseElement("leaf",r);if(n)return e.parseElement("indirectExpression",r,n);e.raiseParseError(r,"Unexpected value: "+r.currentToken().value)}))}use(e){return e(this),this}GRAMMAR={};COMMANDS={};FEATURES={};LEAF_EXPRESSIONS=[];INDIRECT_EXPRESSIONS=[];initElt(e,t,r){e.startToken=t,e.sourceFor=i.sourceFor,e.lineFor=i.lineFor,e.programSource=r.source}parseElement(e,t,r){var n=this.GRAMMAR[e];if(n){var i=t.currentToken(),a=n(this,this.runtime,t,r);if(a){this.initElt(a,i,t),a.endToken=a.endToken||t.lastMatch();for(r=a.root;null!=r;)this.initElt(r,i,t),r=r.root}return a}}requireElement(e,t,r,n){var i=this.parseElement(e,t,n);return i||a.raiseParseError(t,r||"Expected "+e),i}parseAnyOf(e,t){for(var r=0;r<e.length;r++){var n=e[r],i=this.parseElement(n,t);if(i)return i}}addGrammarElement(e,t){this.GRAMMAR[e]=t}addCommand(e,t){var r=e+"Command",n=function(e,n,i){const a=t(e,n,i);if(a)return a.type=r,a.execute=function(e){return e.meta.command=a,n.unifiedExec(this,e)},a};this.GRAMMAR[r]=n,this.COMMANDS[e]=n}addFeature(e,t){var r=e+"Feature",n=function(n,i,a){var o=t(n,i,a);if(o)return o.isFeature=!0,o.keyword=e,o.type=r,o};this.GRAMMAR[r]=n,this.FEATURES[e]=n}addLeafExpression(e,t){this.LEAF_EXPRESSIONS.push(e),this.addGrammarElement(e,t)}addIndirectExpression(e,t){this.INDIRECT_EXPRESSIONS.push(e),this.addGrammarElement(e,t)}static createParserContext(e){var t=e.currentToken(),r=e.source.split("\n"),n=r[t&&t.line?t.line-1:r.length-1],i=t&&t.line?t.column:n.length-1;return n+"\n"+" ".repeat(i)+"^^\n\n"}static raiseParseError(e,t){t=(t||"Unexpected Token : "+e.currentToken().value)+"\n\n"+a.createParserContext(e);var r=new Error(t);throw r.tokens=e,r}raiseParseError(e,t){a.raiseParseError(e,t)}parseHyperScript(e){var t=this.parseElement("hyperscript",e);if(e.hasMore()&&this.raiseParseError(e),t)return t}setParent(e,t){"object"==typeof e&&(e.parent=t,"object"==typeof t&&(t.children=t.children||new Set,t.children.add(e)),this.setParent(e.next,t))}commandStart(e){return this.COMMANDS[e.value||""]}featureStart(e){return this.FEATURES[e.value||""]}commandBoundary(e){return!("end"!=e.value&&"then"!=e.value&&"else"!=e.value&&"otherwise"!=e.value&&")"!=e.value&&!this.commandStart(e)&&!this.featureStart(e)&&"EOF"!=e.type)}parseStringTemplate(e){var t=[""];do{if(t.push(e.lastWhitespace()),"$"===e.currentToken().value){e.consumeToken();var r=e.matchOpToken("{");t.push(this.requireElement("expression",e)),r&&e.requireOpToken("}"),t.push("")}else if("\\"===e.currentToken().value)e.consumeToken(),e.consumeToken();else{var n=e.consumeToken();t[t.length-1]+=n?n.value:""}}while(e.hasMore());return t.push(e.lastWhitespace()),t}ensureTerminated(e){const t=this.runtime;for(var r={type:"implicitReturn",op:function(e){return e.meta.returned=!0,e.meta.resolve&&e.meta.resolve(),t.HALT},execute:function(e){}},n=e;n.next;)n=n.next;n.next=r}}class o{constructor(e,t){this.lexer=e??new n,this.parser=t??new a(this).use(p).use(h),this.parser.runtime=this}matchesSelector(e,t){var r=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector;return r&&r.call(e,t)}makeEvent(t,r){var n;return e.Event&&"function"==typeof e.Event?(n=new Event(t,{bubbles:!0,cancelable:!0})).detail=r:(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,r),n}triggerEvent(e,t,r,n){(r=r||{}).sender=n;var i=this.makeEvent(t,r);return e.dispatchEvent(i)}isArrayLike(e){return Array.isArray(e)||"undefined"!=typeof NodeList&&(e instanceof NodeList||e instanceof HTMLCollection)}isIterable(e){return"object"==typeof e&&Symbol.iterator in e&&"function"==typeof e[Symbol.iterator]}shouldAutoIterate(e){return null!=e&&e[l]||this.isArrayLike(e)}forEach(e,t){if(null==e);else if(this.isIterable(e))for(const r of e)t(r);else if(this.isArrayLike(e))for(var r=0;r<e.length;r++)t(e[r]);else t(e)}implicitLoop(e,t){if(this.shouldAutoIterate(e))for(const r of e)t(r);else t(e)}wrapArrays(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];Array.isArray(n)?t.push(Promise.all(n)):t.push(n)}return t}unwrapAsyncs(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.asyncWrapper&&(e[t]=r.value),Array.isArray(r))for(var n=0;n<r.length;n++){var i=r[n];i.asyncWrapper&&(r[n]=i.value)}}}static HALT={};HALT=o.HALT;unifiedExec(e,t){for(;;){try{var r=this.unifiedEval(e,t)}catch(n){if(t.meta.handlingFinally)console.error(" Exception in finally block: ",n),r=o.HALT;else{if(this.registerHyperTrace(t,n),t.meta.errorHandler&&!t.meta.handlingError){t.meta.handlingError=!0,t.locals[t.meta.errorSymbol]=n,e=t.meta.errorHandler;continue}t.meta.currentException=n,r=o.HALT}}if(null==r)return void console.error(e," did not return a next element to execute! context: ",t);if(r.then)return void r.then((e=>{this.unifiedExec(e,t)})).catch((e=>{this.unifiedExec({op:function(){throw e}},t)}));if(r===o.HALT){if(!t.meta.finallyHandler||t.meta.handlingFinally){if(t.meta.onHalt&&t.meta.onHalt(),t.meta.currentException){if(t.meta.reject)return void t.meta.reject(t.meta.currentException);throw t.meta.currentException}return}t.meta.handlingFinally=!0,e=t.meta.finallyHandler}else e=r}}unifiedEval(e,t){var r=[t],n=!1,i=!1;if(e.args)for(var a=0;a<e.args.length;a++){var o=e.args[a];if(null==o)r.push(null);else if(Array.isArray(o)){for(var s=[],u=0;u<o.length;u++){var l=o[u];(c=l?l.evaluate(t):null)&&(c.then?n=!0:c.asyncWrapper&&(i=!0)),s.push(c)}r.push(s)}else if(o.evaluate){var c;(c=o.evaluate(t))&&(c.then?n=!0:c.asyncWrapper&&(i=!0)),r.push(c)}else r.push(o)}return n?new Promise(((t,n)=>{r=this.wrapArrays(r),Promise.all(r).then((function(r){i&&this.unwrapAsyncs(r);try{var a=e.op.apply(e,r);t(a)}catch(e){n(e)}})).catch((function(e){n(e)}))})):(i&&this.unwrapAsyncs(r),e.op.apply(e,r))}_scriptAttrs=null;getScriptAttributes(){return null==this._scriptAttrs&&(this._scriptAttrs=r.attributes.replace(/ /g,"").split(",")),this._scriptAttrs}getScript(e){for(var t=0;t<this.getScriptAttributes().length;t++){var r=this.getScriptAttributes()[t];if(e.hasAttribute&&e.hasAttribute(r))return e.getAttribute(r)}return e instanceof HTMLScriptElement&&"text/hyperscript"===e.type?e.innerText:null}hyperscriptFeaturesMap=new WeakMap;getHyperscriptFeatures(e){var t=this.hyperscriptFeaturesMap.get(e);return void 0===t&&e&&this.hyperscriptFeaturesMap.set(e,t={}),t}addFeatures(e,t){e&&(Object.assign(t.locals,this.getHyperscriptFeatures(e)),this.addFeatures(e.parentElement,t))}makeContext(e,t,r,n){return new s(e,t,r,n,this)}getScriptSelector(){return this.getScriptAttributes().map((function(e){return"["+e+"]"})).join(", ")}convertValue(e,r){for(var n=t.dynamicResolvers,i=0;i<n.length;i++){var a=(0,n[i])(r,e);if(void 0!==a)return a}if(null==e)return null;var o=t[r];if(o)return o(e);throw"Unknown conversion : "+r}parse(e){const t=this.lexer,r=this.parser;var n=t.tokenize(e);if(this.parser.commandStart(n.currentToken())){var i=r.requireElement("commandList",n);return n.hasMore()&&r.raiseParseError(n),r.ensureTerminated(i),i}if(r.featureStart(n.currentToken())){var a=r.requireElement("hyperscript",n);return n.hasMore()&&r.raiseParseError(n),a}var o=r.requireElement("expression",n);return n.hasMore()&&r.raiseParseError(n),o}evaluateNoPromise(e,t){let r=e.evaluate(t);if(r.next)throw new Error(i.sourceFor.call(e)+" returned a Promise in a context that they are not allowed.");return r}evaluate(t,r,n){class i extends EventTarget{constructor(e){super(),this.module=e}toString(){return this.module.id}}var a="document"in e?e.document.body:new i(n&&n.module);r=Object.assign(this.makeContext(a,null,a,null),r||{});var o=this.parse(t);return o.execute?(o.execute(r),r.result):o.apply?(o.apply(a,a,n),this.getHyperscriptFeatures(a)):o.evaluate(r)}processNode(e){var t=this.getScriptSelector();this.matchesSelector(e,t)&&this.initElement(e,e),e instanceof HTMLScriptElement&&"text/hyperscript"===e.type&&this.initElement(e,document.body),e.querySelectorAll&&this.forEach(e.querySelectorAll(t+", [type='text/hyperscript']"),(e=>{this.initElement(e,e instanceof HTMLScriptElement&&"text/hyperscript"===e.type?document.body:e)}))}initElement(e,t){if(!e.closest||!e.closest(r.disableSelector)){var n=this.getInternalData(e);if(!n.initialized){var i=this.getScript(e);if(i)try{n.initialized=!0,n.script=i;const r=this.lexer,s=this.parser;var a=r.tokenize(i),o=s.parseHyperScript(a);if(!o)return;o.apply(t||e,e),setTimeout((()=>{this.triggerEvent(t||e,"load",{hyperscript:!0})}),1)}catch(t){this.triggerEvent(e,"exception",{error:t}),console.error("hyperscript errors were found on the following element:",e,"\n\n",t.message,t.stack)}}}}internalDataMap=new WeakMap;getInternalData(e){var t=this.internalDataMap.get(e);return void 0===t&&this.internalDataMap.set(e,t={}),t}typeCheck(e,t,r){return!(null!=e||!r)||Object.prototype.toString.call(e).slice(8,-1)===t}getElementScope(e){var t=e.meta&&e.meta.owner;if(t){var r=this.getInternalData(t),n="elementScope";return e.meta.feature&&e.meta.feature.behavior&&(n=e.meta.feature.behavior+"Scope"),c(r,n)}return{}}isReservedWord(e){return["meta","it","result","locals","event","target","detail","sender","body"].includes(e)}isHyperscriptContext(e){return e instanceof s}resolveSymbol(t,r,n){if("me"===t||"my"===t||"I"===t)return r.me;if("it"===t||"its"===t||"result"===t)return r.result;if("you"===t||"your"===t||"yourself"===t)return r.you;if("global"===n)return e[t];if("element"===n)return this.getElementScope(r)[t];if("local"===n)return r.locals[t];if(r.meta&&r.meta.context){var i=r.meta.context[t];if(void 0!==i)return i;if(r.meta.context.detail&&void 0!==(i=r.meta.context.detail[t]))return i}if(this.isHyperscriptContext(r)&&!this.isReservedWord(t))var a=r.locals[t];else a=r[t];return void 0!==a||void 0!==(a=this.getElementScope(r)[t])?a:e[t]}setSymbol(t,r,n,i){if("global"===n)e[t]=i;else if("element"===n){(a=this.getElementScope(r))[t]=i}else if("local"===n)r.locals[t]=i;else if(this.isHyperscriptContext(r)&&!this.isReservedWord(t)&&void 0!==r.locals[t])r.locals[t]=i;else{var a;void 0!==(a=this.getElementScope(r))[t]?a[t]=i:this.isHyperscriptContext(r)&&!this.isReservedWord(t)?r.locals[t]=i:r[t]=i}}findNext(e,t){if(e)return e.resolveNext?e.resolveNext(t):e.next?e.next:this.findNext(e.parent,t)}flatGet(e,t,r){if(null!=e){var n=r(e,t);if(void 0!==n)return n;if(this.shouldAutoIterate(e)){var i=[];for(var a of e){var o=r(a,t);i.push(o)}return i}}}resolveProperty(e,t){return this.flatGet(e,t,((e,t)=>e[t]))}resolveAttribute(e,t){return this.flatGet(e,t,((e,t)=>e.getAttribute&&e.getAttribute(t)))}resolveStyle(e,t){return this.flatGet(e,t,((e,t)=>e.style&&e.style[t]))}resolveComputedStyle(e,t){return this.flatGet(e,t,((e,t)=>getComputedStyle(e).getPropertyValue(t)))}assignToNamespace(t,r,n,i){let a;var o;for(a="undefined"!=typeof document&&t===document.body?e:this.getHyperscriptFeatures(t);void 0!==(o=r.shift());){var s=a[o];null==s&&(s={},a[o]=s),a=s}a[n]=i}getHyperTrace(e,t){for(var r=e;r.meta.caller;)r=r.meta.caller;if(r.meta.traceMap)return r.meta.traceMap.get(t,[])}registerHyperTrace(e,t){for(var r=[],n=null;null!=e;)r.push(e),n=e,e=e.meta.caller;if(null==n.meta.traceMap&&(n.meta.traceMap=new Map),!n.meta.traceMap.get(t)){var i={trace:r,print:function(e){(e=e||console.error)("hypertrace /// ");for(var t=0,n=0;n<r.length;n++)t=Math.max(t,r[n].meta.feature.displayName.length);for(n=0;n<r.length;n++){var i=r[n];e("  ->",i.meta.feature.displayName.padEnd(t+2),"-",i.meta.owner)}}};n.meta.traceMap.set(t,i)}}escapeSelector(e){return e.replace(/:/g,(function(e){return"\\"+e}))}nullCheck(e,t){if(null==e)throw new Error("'"+t.sourceFor()+"' is null")}isEmpty(e){return null==e||0===e.length}doesExist(e){if(null==e)return!1;if(this.shouldAutoIterate(e)){for(const t of e)return!0;return!1}return!0}getRootNode(e){if(e&&e instanceof Node){var t=e.getRootNode();if(t instanceof Document||t instanceof ShadowRoot)return t}return document}getEventQueueFor(e,t){let r=this.getInternalData(e);var n=r.eventQueues;null==n&&(n=new Map,r.eventQueues=n);var i=n.get(t);return null==i&&(i={queue:[],executing:!1},n.set(t,i)),i}hyperscriptUrl="document"in e&&document.currentScript?document.currentScript.src:null}class s{constructor(t,r,n,i,a){this.meta={parser:a.parser,lexer:a.lexer,runtime:a,owner:t,feature:r,iterators:{},ctx:this},this.locals={},this.me=n,this.you=void 0,this.result=void 0,this.event=i,this.target=i?i.target:null,this.detail=i?i.detail:null,this.sender=i&&i.detail?i.detail.sender:null,this.body="document"in e?document.body:null,a.addFeatures(t,this)}}class u{constructor(e,t,r){this._css=e,this.relativeToElement=t,this.escape=r,this[l]=!0}get css(){return this.escape?o.prototype.escapeSelector(this._css):this._css}get className(){return this._css.substr(1)}get id(){return this.className()}contains(e){for(let t of this)if(t.contains(e))return!0;return!1}get length(){return this.selectMatches().length}[Symbol.iterator](){return this.selectMatches()[Symbol.iterator]()}selectMatches(){return o.prototype.getRootNode(this.relativeToElement).querySelectorAll(this.css)}}const l=Symbol();function c(e,t){var r=e[t];if(r)return r;var n={};return e[t]=n,n}function m(e){try{return JSON.parse(e)}catch(e){return function(e){console.error?console.error(e):console.log&&console.log("ERROR: ",e)}(e),null}}function f(e,t){return new(e.bind.apply(e,[e].concat(t)))}function p(t){t.addLeafExpression("parenthesized",(function(e,t,r){if(r.matchOpToken("(")){var n=r.clearFollows();try{var i=e.requireElement("expression",r)}finally{r.restoreFollows(n)}return r.requireOpToken(")"),i}})),t.addLeafExpression("string",(function(e,t,r){var i=r.matchTokenType("STRING");if(i){var a,o=i.value;if(i.template){var s=n.tokenize(o,!0);a=e.parseStringTemplate(s)}else a=[];return{type:"string",token:i,args:a,op:function(e){for(var t="",r=1;r<arguments.length;r++){var n=arguments[r];void 0!==n&&(t+=n)}return t},evaluate:function(e){return 0===a.length?o:t.unifiedEval(this,e)}}}})),t.addGrammarElement("nakedString",(function(e,t,r){if(r.hasMore()){var n=r.consumeUntilWhitespace();return r.matchTokenType("WHITESPACE"),{type:"nakedString",tokens:n,evaluate:function(e){return n.map((function(e){return e.value})).join("")}}}})),t.addLeafExpression("number",(function(e,t,r){var n=r.matchTokenType("NUMBER");if(n){var i=n,a=parseFloat(n.value);return{type:"number",value:a,numberToken:i,evaluate:function(){return a}}}})),t.addLeafExpression("idRef",(function(e,t,r){var i=r.matchTokenType("ID_REF");if(i&&i.value){if(i.template){var a=i.value.substring(2),o=n.tokenize(a);return{type:"idRefTemplate",args:[e.requireElement("expression",o)],op:function(e,r){return t.getRootNode(e.me).getElementById(r)},evaluate:function(e){return t.unifiedEval(this,e)}}}{const e=i.value.substring(1);return{type:"idRef",css:i.value,value:e,evaluate:function(r){return t.getRootNode(r.me).getElementById(e)}}}}})),t.addLeafExpression("classRef",(function(e,t,r){var i=r.matchTokenType("CLASS_REF");if(i&&i.value){if(i.template){var a=i.value.substring(2),o=n.tokenize(a);return{type:"classRefTemplate",args:[e.requireElement("expression",o)],op:function(e,t){return new u("."+t,e.me,!0)},evaluate:function(e){return t.unifiedEval(this,e)}}}{const e=i.value;return{type:"classRef",css:e,evaluate:function(t){return new u(e,t.me,!0)}}}}}));class r extends u{constructor(e,t,r){super(e,t),this.templateParts=r,this.elements=r.filter((e=>e instanceof Element))}get css(){let e="",t=0;for(const r of this.templateParts)r instanceof Element?e+="[data-hs-query-id='"+t+++"']":e+=r;return e}[Symbol.iterator](){this.elements.forEach(((e,t)=>e.dataset.hsQueryId=t));const e=super[Symbol.iterator]();return this.elements.forEach((e=>e.removeAttribute("data-hs-query-id"))),e}}t.addLeafExpression("queryRef",(function(e,t,i){if(i.matchOpToken("<")){var a=i.consumeUntil("/");i.requireOpToken("/"),i.requireOpToken(">");var o,s,l,c=a.map((function(e){return"STRING"===e.type?'"'+e.value+'"':e.value})).join("");return c.indexOf("$")>=0&&(o=!0,s=n.tokenize(c,!0),l=e.parseStringTemplate(s)),{type:"queryRef",css:c,args:l,op:function(e,...t){return o?new r(c,e.me,t):new u(c,e.me)},evaluate:function(e){return t.unifiedEval(this,e)}}}})),t.addLeafExpression("attributeRef",(function(e,t,r){var n=r.matchTokenType("ATTRIBUTE_REF");if(n&&n.value){var i=n.value;if(0===i.indexOf("["))var a=i.substring(2,i.length-1);else a=i.substring(1);var o="["+a+"]",s=a.split("="),u=s[0],l=s[1];return l&&0===l.indexOf('"')&&(l=l.substring(1,l.length-1)),{type:"attributeRef",name:u,css:o,value:l,op:function(e){var t=e.you||e.me;if(t)return t.getAttribute(u)},evaluate:function(e){return t.unifiedEval(this,e)}}}})),t.addLeafExpression("styleRef",(function(e,t,r){var n=r.matchTokenType("STYLE_REF");if(n&&n.value){var i=n.value.substr(1);return i.startsWith("computed-")?{type:"computedStyleRef",name:i=i.substr(9),op:function(e){var r=e.you||e.me;if(r)return t.resolveComputedStyle(r,i)},evaluate:function(e){return t.unifiedEval(this,e)}}:{type:"styleRef",name:i,op:function(e){var r=e.you||e.me;if(r)return t.resolveStyle(r,i)},evaluate:function(e){return t.unifiedEval(this,e)}}}})),t.addGrammarElement("objectKey",(function(e,t,r){var n;if(n=r.matchTokenType("STRING"))return{type:"objectKey",key:n.value,evaluate:function(){return n.value}};if(r.matchOpToken("[")){var i=e.parseElement("expression",r);return r.requireOpToken("]"),{type:"objectKey",expr:i,args:[i],op:function(e,t){return t},evaluate:function(e){return t.unifiedEval(this,e)}}}var a="";do{(n=r.matchTokenType("IDENTIFIER")||r.matchOpToken("-"))&&(a+=n.value)}while(n);return{type:"objectKey",key:a,evaluate:function(){return a}}})),t.addLeafExpression("objectLiteral",(function(e,t,r){if(r.matchOpToken("{")){var n=[],i=[];if(!r.matchOpToken("}")){do{var a=e.requireElement("objectKey",r);r.requireOpToken(":");var o=e.requireElement("expression",r);i.push(o),n.push(a)}while(r.matchOpToken(","));r.requireOpToken("}")}return{type:"objectLiteral",args:[n,i],op:function(e,t,r){for(var n={},i=0;i<t.length;i++)n[t[i]]=r[i];return n},evaluate:function(e){return t.unifiedEval(this,e)}}}})),t.addGrammarElement("nakedNamedArgumentList",(function(e,t,r){var n=[],i=[];if("IDENTIFIER"===r.currentToken().type)do{var a=r.requireTokenType("IDENTIFIER");r.requireOpToken(":");var o=e.requireElement("expression",r);i.push(o),n.push({name:a,value:o})}while(r.matchOpToken(","));return{type:"namedArgumentList",fields:n,args:[i],op:function(e,t){for(var r={_namedArgList_:!0},i=0;i<t.length;i++){r[n[i].name.value]=t[i]}return r},evaluate:function(e){return t.unifiedEval(this,e)}}})),t.addGrammarElement("namedArgumentList",(function(e,t,r){if(r.matchOpToken("(")){var n=e.requireElement("nakedNamedArgumentList",r);return r.requireOpToken(")"),n}})),t.addGrammarElement("symbol",(function(e,t,r){var n="default";r.matchToken("global")?n="global":r.matchToken("element")||r.matchToken("module")?(n="element",r.matchOpToken("'")&&r.requireToken("s")):r.matchToken("local")&&(n="local");let i=r.matchOpToken(":"),a=r.matchTokenType("IDENTIFIER");if(a&&a.value){var o=a.value;return i&&(o=":"+o),"default"===n&&(0===o.indexOf("$")&&(n="global"),0===o.indexOf(":")&&(n="element")),{type:"symbol",token:a,scope:n,name:o,evaluate:function(e){return t.resolveSymbol(o,e,n)}}}})),t.addGrammarElement("implicitMeTarget",(function(e,t,r){return{type:"implicitMeTarget",evaluate:function(e){return e.you||e.me}}})),t.addLeafExpression("boolean",(function(e,t,r){var n=r.matchToken("true")||r.matchToken("false");if(!n)return;const i="true"===n.value;return{type:"boolean",evaluate:function(e){return i}}})),t.addLeafExpression("null",(function(e,t,r){if(r.matchToken("null"))return{type:"null",evaluate:function(e){return null}}})),t.addLeafExpression("arrayLiteral",(function(e,t,r){if(r.matchOpToken("[")){var n=[];if(!r.matchOpToken("]")){do{var i=e.requireElement("expression",r);n.push(i)}while(r.matchOpToken(","));r.requireOpToken("]")}return{type:"arrayLiteral",values:n,args:[n],op:function(e,t){return t},evaluate:function(e){return t.unifiedEval(this,e)}}}})),t.addLeafExpression("blockLiteral",(function(e,t,r){if(r.matchOpToken("\\")){var n=[],i=r.matchTokenType("IDENTIFIER");if(i)for(n.push(i);r.matchOpToken(",");)n.push(r.requireTokenType("IDENTIFIER"));r.requireOpToken("-"),r.requireOpToken(">");var a=e.requireElement("expression",r);return{type:"blockLiteral",args:n,expr:a,evaluate:function(e){return function(){for(var t=0;t<n.length;t++)e.locals[n[t].value]=arguments[t];return a.evaluate(e)}}}}})),t.addIndirectExpression("propertyAccess",(function(e,t,r,n){if(r.matchOpToken(".")){var i=r.requireTokenType("IDENTIFIER"),a={type:"propertyAccess",root:n,prop:i,args:[n],op:function(e,r){return t.resolveProperty(r,i.value)},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",r,a)}})),t.addIndirectExpression("of",(function(e,t,r,n){if(r.matchToken("of")){for(var i=e.requireElement("unaryExpression",r),a=null,o=n;o.root;)a=o,o=o.root;"symbol"!==o.type&&"attributeRef"!==o.type&&"styleRef"!==o.type&&"computedStyleRef"!==o.type&&e.raiseParseError(r,"Cannot take a property of a non-symbol: "+o.type);var s="attributeRef"===o.type,u="styleRef"===o.type||"computedStyleRef"===o.type;if(s||u)var l=o;var c=o.name,m={type:"ofExpression",prop:o.token,root:i,attribute:l,expression:n,args:[i],op:function(e,r){return s?t.resolveAttribute(r,c):u?"computedStyleRef"===o.type?t.resolveComputedStyle(r,c):t.resolveStyle(r,c):t.resolveProperty(r,c)},evaluate:function(e){return t.unifiedEval(this,e)}};return"attributeRef"===o.type&&(m.attribute=o),a?(a.root=m,a.args=[m]):n=m,e.parseElement("indirectExpression",r,n)}})),t.addIndirectExpression("possessive",(function(e,t,r,n){if(!e.possessivesDisabled){var i=r.matchOpToken("'");if(i||"symbol"===n.type&&("my"===n.name||"its"===n.name||"your"===n.name)&&("IDENTIFIER"===r.currentToken().type||"ATTRIBUTE_REF"===r.currentToken().type||"STYLE_REF"===r.currentToken().type)){var a,o,s;i&&r.requireToken("s"),null==(a=e.parseElement("attributeRef",r))&&null==(o=e.parseElement("styleRef",r))&&(s=r.requireTokenType("IDENTIFIER"));var u={type:"possessive",root:n,attribute:a||o,prop:s,args:[n],op:function(e,r){if(a)var n=t.resolveAttribute(r,a.name);else if(o){n="computedStyleRef"===o.type?t.resolveComputedStyle(r,o.name):t.resolveStyle(r,o.name)}else n=t.resolveProperty(r,s.value);return n},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",r,u)}}})),t.addIndirectExpression("inExpression",(function(e,t,r,n){if(r.matchToken("in")){var i={type:"inExpression",root:n,args:[n,e.requireElement("unaryExpression",r)],op:function(e,r,n){var i=[];if(r.css)t.implicitLoop(n,(function(e){for(var t=e.querySelectorAll(r.css),n=0;n<t.length;n++)i.push(t[n])}));else if(r instanceof Element){var a=!1;if(t.implicitLoop(n,(function(e){e.contains(r)&&(a=!0)})),a)return r}else t.implicitLoop(r,(function(e){t.implicitLoop(n,(function(t){e===t&&i.push(e)}))}));return i},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",r,i)}})),t.addIndirectExpression("asExpression",(function(e,t,r,n){if(r.matchToken("as")){r.matchToken("a")||r.matchToken("an");var i=e.requireElement("dotOrColonPath",r).evaluate(),a={type:"asExpression",root:n,args:[n],op:function(e,r){return t.convertValue(r,i)},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",r,a)}})),t.addIndirectExpression("functionCall",(function(e,t,r,n){if(r.matchOpToken("(")){var i=[];if(!r.matchOpToken(")")){do{i.push(e.requireElement("expression",r))}while(r.matchOpToken(","));r.requireOpToken(")")}if(n.root)var a={type:"functionCall",root:n,argExressions:i,args:[n.root,i],op:function(e,r,i){t.nullCheck(r,n.root);var a=r[n.prop.value];return t.nullCheck(a,n),a.hyperfunc&&i.push(e),a.apply(r,i)},evaluate:function(e){return t.unifiedEval(this,e)}};else a={type:"functionCall",root:n,argExressions:i,args:[n,i],op:function(e,r,i){return t.nullCheck(r,n),r.hyperfunc&&i.push(e),r.apply(null,i)},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",r,a)}})),t.addIndirectExpression("attributeRefAccess",(function(e,t,r,n){var i=e.parseElement("attributeRef",r);if(i){var a={type:"attributeRefAccess",root:n,attribute:i,args:[n],op:function(e,r){return t.resolveAttribute(r,i.name)},evaluate:function(e){return t.unifiedEval(this,e)}};return a}})),t.addIndirectExpression("arrayIndex",(function(e,t,r,n){if(r.matchOpToken("[")){var i=!1,a=!1,o=null,s=null;if(r.matchOpToken(".."))i=!0,o=e.requireElement("expression",r);else if(o=e.requireElement("expression",r),r.matchOpToken(".."))a=!0,"R_BRACKET"!==r.currentToken().type&&(s=e.parseElement("expression",r));r.requireOpToken("]");var u={type:"arrayIndex",root:n,prop:o,firstIndex:o,secondIndex:s,args:[n,o,s],op:function(e,t,r,n){return null==t?null:i?(r<0&&(r=t.length+r),t.slice(0,r+1)):a?null!=n?(n<0&&(n=t.length+n),t.slice(r,n+1)):t.slice(r):t[r]},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",r,u)}}));var a=["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","pc","pt","px"];t.addGrammarElement("postfixExpression",(function(e,t,r){var n=e.parseElement("primaryExpression",r);let i=r.matchAnyToken.apply(r,a)||r.matchOpToken("%");if(i)return{type:"stringPostfix",postfix:i.value,args:[n],op:function(e,t){return""+t+i.value},evaluate:function(e){return t.unifiedEval(this,e)}};var o=null;if(r.matchToken("s")||r.matchToken("seconds")?o=1e3:(r.matchToken("ms")||r.matchToken("milliseconds"))&&(o=1),o)return{type:"timeExpression",time:n,factor:o,args:[n],op:function(e,t){return t*o},evaluate:function(e){return t.unifiedEval(this,e)}};if(r.matchOpToken(":")){var s=r.requireTokenType("IDENTIFIER");if(!s.value)return;var u=!r.matchOpToken("!");return{type:"typeCheck",typeName:s,nullOk:u,args:[n],op:function(e,r){if(t.typeCheck(r,this.typeName.value,u))return r;throw new Error("Typecheck failed!  Expected: "+s.value)},evaluate:function(e){return t.unifiedEval(this,e)}}}return n})),t.addGrammarElement("logicalNot",(function(e,t,r){if(r.matchToken("not")){var n=e.requireElement("unaryExpression",r);return{type:"logicalNot",root:n,args:[n],op:function(e,t){return!t},evaluate:function(e){return t.unifiedEval(this,e)}}}})),t.addGrammarElement("noExpression",(function(e,t,r){if(r.matchToken("no")){var n=e.requireElement("unaryExpression",r);return{type:"noExpression",root:n,args:[n],op:function(e,r){return t.isEmpty(r)},evaluate:function(e){return t.unifiedEval(this,e)}}}})),t.addLeafExpression("some",(function(e,t,r){if(r.matchToken("some")){var n=e.requireElement("expression",r);return{type:"noExpression",root:n,args:[n],op:function(e,r){return!t.isEmpty(r)},evaluate(e){return t.unifiedEval(this,e)}}}})),t.addGrammarElement("negativeNumber",(function(e,t,r){if(r.matchOpToken("-")){var n=e.requireElement("unaryExpression",r);return{type:"negativeNumber",root:n,args:[n],op:function(e,t){return-1*t},evaluate:function(e){return t.unifiedEval(this,e)}}}})),t.addGrammarElement("unaryExpression",(function(e,t,r){return r.matchToken("the"),e.parseAnyOf(["beepExpression","logicalNot","relativePositionalExpression","positionalExpression","noExpression","negativeNumber","postfixExpression"],r)})),t.addGrammarElement("beepExpression",(function(e,t,r){if(r.matchToken("beep!")){var n=e.parseElement("unaryExpression",r);if(n){n.booped=!0;var a=n.evaluate;return n.evaluate=function(e){let r=a.apply(n,arguments),o=e.me;if(t.triggerEvent(o,"hyperscript:beep",{element:o,expression:n,value:r})){var s,l=r;"String"===(s=r?r instanceof u?"ElementCollection":r.constructor?r.constructor.name:"unknown":"object (null)")?l='"'+l+'"':r instanceof u&&(l=Array.from(r)),console.log("///_ BEEP! The expression ("+i.sourceFor.call(n).substr(6)+") evaluates to:",l,"of type "+s)}return r},n}}}));var s=function(e,t,r,n){var i=[];o.prototype.forEach(t,(function(t){(t.matches(r)||t===e)&&i.push(t)}));for(var a=0;a<i.length-1;a++){if(i[a]===e)return i[a+1]}if(n){var s=i[0];if(s&&s.matches(r))return s}};function l(e,t,r){if(t.contains)return t.contains(r);if(t.includes)return t.includes(r);throw Error("The value of "+e.sourceFor()+" does not have a contains or includes method on it")}function m(e,t,r){if(t.match)return!!t.match(r);if(t.matches)return t.matches(r);throw Error("The value of "+e.sourceFor()+" does not have a match or matches method on it")}t.addGrammarElement("relativePositionalExpression",(function(e,t,r){var n=r.matchAnyToken("next","previous");if(n){var i="next"===n.value,a=e.parseElement("expression",r);if(r.matchToken("from")){r.pushFollow("in");try{var o=e.requireElement("unaryExpression",r)}finally{r.popFollow()}}else o=e.requireElement("implicitMeTarget",r);var u,l=!1;if(r.matchToken("in")){l=!0;var c=e.requireElement("unaryExpression",r)}else u=r.matchToken("within")?e.requireElement("unaryExpression",r):document.body;var m=!1;return r.matchToken("with")&&(r.requireToken("wrapping"),m=!0),{type:"relativePositionalExpression",from:o,forwardSearch:i,inSearch:l,wrapping:m,inElt:c,withinElt:u,operator:n.value,args:[a,o,c,u],op:function(e,t,r,n,a){var o=t.css;if(null==o)throw"Expected a CSS value";if(l){if(n)return i?s(r,n,o,m):function(e,t,r,n){return s(e,Array.from(t).reverse(),r,n)}(r,n,o,m)}else if(a)return i?function(e,t,r,n){for(var i=t.querySelectorAll(r),a=0;a<i.length;a++){var o=i[a];if(o.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_PRECEDING)return o}if(n)return i[0]}(r,a,o,m):function(e,t,r,n){for(var i=t.querySelectorAll(r),a=i.length-1;a>=0;a--){var o=i[a];if(o.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_FOLLOWING)return o}if(n)return i[i.length-1]}(r,a,o,m)},evaluate:function(e){return t.unifiedEval(this,e)}}}})),t.addGrammarElement("positionalExpression",(function(e,t,r){var n=r.matchAnyToken("first","last","random");if(!n)return;r.matchAnyToken("in","from","of");var i=e.requireElement("unaryExpression",r);const a=n.value;return{type:"positionalExpression",rhs:i,operator:n.value,args:[i],op:function(e,t){if(t&&!Array.isArray(t)&&(t=t.children?t.children:Array.from(t)),t){if("first"===a)return t[0];if("last"===a)return t[t.length-1];if("random"===a)return t[Math.floor(Math.random()*t.length)]}},evaluate:function(e){return t.unifiedEval(this,e)}}})),t.addGrammarElement("mathOperator",(function(e,t,r){var n,i=e.parseElement("unaryExpression",r),a=null;for(n=r.matchAnyOpToken("+","-","*","/")||r.matchToken("mod");n;){a=a||n;var o=n.value;a.value!==o&&e.raiseParseError(r,"You must parenthesize math operations with different operators");var s=e.parseElement("unaryExpression",r);i={type:"mathOperator",lhs:i,rhs:s,operator:o,args:[i,s],op:function(e,t,r){return"+"===o?t+r:"-"===o?t-r:"*"===o?t*r:"/"===o?t/r:"mod"===o?t%r:void 0},evaluate:function(e){return t.unifiedEval(this,e)}},n=r.matchAnyOpToken("+","-","*","/")||r.matchToken("mod")}return i})),t.addGrammarElement("mathExpression",(function(e,t,r){return e.parseAnyOf(["mathOperator","unaryExpression"],r)})),t.addGrammarElement("comparisonOperator",(function(e,t,r){var n=e.parseElement("mathExpression",r),i=r.matchAnyOpToken("<",">","<=",">=","==","===","!=","!=="),a=i?i.value:null,o=!0,s=!1;if(null==a&&(r.matchToken("is")||r.matchToken("am")?r.matchToken("not")?r.matchToken("in")?a="not in":r.matchToken("a")?(a="not a",s=!0):r.matchToken("empty")?(a="not empty",o=!1):a="!=":r.matchToken("in")?a="in":r.matchToken("a")?(a="a",s=!0):r.matchToken("empty")?(a="empty",o=!1):r.matchToken("less")?(r.requireToken("than"),r.matchToken("or")?(r.requireToken("equal"),r.requireToken("to"),a="<="):a="<"):r.matchToken("greater")?(r.requireToken("than"),r.matchToken("or")?(r.requireToken("equal"),r.requireToken("to"),a=">="):a=">"):a="==":r.matchToken("exist")||r.matchToken("exists")?(a="exist",o=!1):r.matchToken("matches")||r.matchToken("match")?a="match":r.matchToken("contains")||r.matchToken("contain")?a="contain":r.matchToken("includes")||r.matchToken("include")?a="include":(r.matchToken("do")||r.matchToken("does"))&&(r.requireToken("not"),r.matchToken("matches")||r.matchToken("match")?a="not match":r.matchToken("contains")||r.matchToken("contain")?a="not contain":r.matchToken("exist")||r.matchToken("exist")?(a="not exist",o=!1):r.matchToken("include")?a="not include":e.raiseParseError(r,"Expected matches or contains"))),a){var u,c,f;s?(u=r.requireTokenType("IDENTIFIER"),c=!r.matchOpToken("!")):o&&(f=e.requireElement("mathExpression",r),"match"!==a&&"not match"!==a||(f=f.css?f.css:f));var p=n;n={type:"comparisonOperator",operator:a,typeName:u,nullOk:c,lhs:n,rhs:f,args:[n,f],op:function(e,r,n){if("=="===a)return r==n;if("!="===a)return r!=n;if("match"===a)return null!=r&&m(p,r,n);if("not match"===a)return null==r||!m(p,r,n);if("in"===a)return null!=n&&l(f,n,r);if("not in"===a)return null==n||!l(f,n,r);if("contain"===a)return null!=r&&l(p,r,n);if("not contain"===a)return null==r||!l(p,r,n);if("include"===a)return null!=r&&l(p,r,n);if("not include"===a)return null==r||!l(p,r,n);if("==="===a)return r===n;if("!=="===a)return r!==n;if("<"===a)return r<n;if(">"===a)return r>n;if("<="===a)return r<=n;if(">="===a)return r>=n;if("empty"===a)return t.isEmpty(r);if("not empty"===a)return!t.isEmpty(r);if("exist"===a)return t.doesExist(r);if("not exist"===a)return!t.doesExist(r);if("a"===a)return t.typeCheck(r,u.value,c);if("not a"===a)return!t.typeCheck(r,u.value,c);throw"Unknown comparison : "+a},evaluate:function(e){return t.unifiedEval(this,e)}}}return n})),t.addGrammarElement("comparisonExpression",(function(e,t,r){return e.parseAnyOf(["comparisonOperator","mathExpression"],r)})),t.addGrammarElement("logicalOperator",(function(e,t,r){var n,i=e.parseElement("comparisonExpression",r),a=null;for(n=r.matchToken("and")||r.matchToken("or");n;){(a=a||n).value!==n.value&&e.raiseParseError(r,"You must parenthesize logical operations with different operators");var o=e.requireElement("comparisonExpression",r);const s=n.value;i={type:"logicalOperator",operator:s,lhs:i,rhs:o,args:[i,o],op:function(e,t,r){return"and"===s?t&&r:t||r},evaluate:function(e){return t.unifiedEval(this,e)}},n=r.matchToken("and")||r.matchToken("or")}return i})),t.addGrammarElement("logicalExpression",(function(e,t,r){return e.parseAnyOf(["logicalOperator","mathExpression"],r)})),t.addGrammarElement("asyncExpression",(function(e,t,r){return r.matchToken("async")?{type:"asyncExpression",value:e.requireElement("logicalExpression",r),evaluate:function(e){return{asyncWrapper:!0,value:this.value.evaluate(e)}}}:e.parseElement("logicalExpression",r)})),t.addGrammarElement("expression",(function(e,t,r){return r.matchToken("the"),e.parseElement("asyncExpression",r)})),t.addGrammarElement("assignableExpression",(function(e,t,r){r.matchToken("the");var n=e.parseElement("primaryExpression",r);return!n||"symbol"!==n.type&&"ofExpression"!==n.type&&"propertyAccess"!==n.type&&"attributeRefAccess"!==n.type&&"attributeRef"!==n.type&&"styleRef"!==n.type&&"arrayIndex"!==n.type&&"possessive"!==n.type?(e.raiseParseError(r,"A target expression must be writable.  The expression type '"+(n&&n.type)+"' is not."),n):n})),t.addGrammarElement("hyperscript",(function(e,t,r){var n=[];if(r.hasMore())for(;e.featureStart(r.currentToken())||"("===r.currentToken().value;){var i=e.requireElement("feature",r);n.push(i),r.matchToken("end")}return{type:"hyperscript",features:n,apply:function(e,t,r){for(const i of n)i.install(e,t,r)}}}));var p=function(e){var t=[];if("("===e.token(0).value&&(")"===e.token(1).value||","===e.token(2).value||")"===e.token(2).value)){e.matchOpToken("(");do{t.push(e.requireTokenType("IDENTIFIER"))}while(e.matchOpToken(","));e.requireOpToken(")")}return t};function h(e,t,r,n){var i=t.requireElement("eventName",n),a=t.parseElement("namedArgumentList",n);if("send"===e&&n.matchToken("to")||"trigger"===e&&n.matchToken("on"))var o=t.requireElement("expression",n);else o=t.requireElement("implicitMeTarget",n);var s={eventName:i,details:a,to:o,args:[o,i,a],op:function(e,t,n,i){return r.nullCheck(t,o),r.forEach(t,(function(t){r.triggerEvent(t,n,i,e.me)})),r.findNext(s,e)}};return s}t.addFeature("on",(function(e,t,r){if(r.matchToken("on")){var n=!1;r.matchToken("every")&&(n=!0);var i=[],a=null;do{var o=e.requireElement("eventName",r,"Expected event name").evaluate();a=a?a+" or "+o:"on "+o;var s,u,l,c,m,f=p(r),h=null;if(r.matchOpToken("[")&&(h=e.requireElement("expression",r),r.requireOpToken("]")),"NUMBER"===r.currentToken().type){var d=r.consumeToken();if(!d.value)return;if(s=parseInt(d.value),r.matchToken("to")){var v=r.consumeToken();if(!v.value)return;u=parseInt(v.value)}else r.matchToken("and")&&(l=!0,r.requireToken("on"))}if("intersection"===o){if(c={},r.matchToken("with")&&(c.with=e.requireElement("expression",r).evaluate()),r.matchToken("having"))do{r.matchToken("margin")?c.rootMargin=e.requireElement("stringLike",r).evaluate():r.matchToken("threshold")?c.threshold=e.requireElement("expression",r).evaluate():e.raiseParseError(r,"Unknown intersection config specification")}while(r.matchToken("and"))}else if("mutation"===o)if(m={},r.matchToken("of"))do{if(r.matchToken("anything"))m.attributes=!0,m.subtree=!0,m.characterData=!0,m.childList=!0;else if(r.matchToken("childList"))m.childList=!0;else if(r.matchToken("attributes"))m.attributes=!0,m.attributeOldValue=!0;else if(r.matchToken("subtree"))m.subtree=!0;else if(r.matchToken("characterData"))m.characterData=!0,m.characterDataOldValue=!0;else if("ATTRIBUTE_REF"===r.currentToken().type){var E=r.consumeToken();null==m.attributeFilter&&(m.attributeFilter=[]),0==E.value.indexOf("@")?m.attributeFilter.push(E.value.substring(1)):e.raiseParseError(r,"Only shorthand attribute references are allowed here")}else e.raiseParseError(r,"Unknown mutation config specification")}while(r.matchToken("or"));else m.attributes=!0,m.characterData=!0,m.childList=!0;var T=null,y=!1;if(r.matchToken("from"))if(r.matchToken("elsewhere"))y=!0;else{r.pushFollow("or");try{T=e.requireElement("expression",r)}finally{r.popFollow()}T||e.raiseParseError(r,'Expected either target value or "elsewhere".')}if(null===T&&!1===y&&r.matchToken("elsewhere")&&(y=!0),r.matchToken("in"))var k=e.parseElement("unaryExpression",r);if(r.matchToken("debounced")){r.requireToken("at");var x=e.requireElement("unaryExpression",r).evaluate({})}else if(r.matchToken("throttled")){r.requireToken("at");var g=e.requireElement("unaryExpression",r).evaluate({})}i.push({execCount:0,every:n,on:o,args:f,filter:h,from:T,inExpr:k,elsewhere:y,startCount:s,endCount:u,unbounded:l,debounceTime:x,throttleTime:g,mutationSpec:m,intersectionSpec:c,debounced:void 0,lastExec:void 0})}while(r.matchToken("or"));var b=!0;if(!n&&r.matchToken("queue"))if(r.matchToken("all"))b=!1;else if(r.matchToken("first"))var S=!0;else if(r.matchToken("none"))var q=!0;else r.requireToken("last");var N,w,I=e.requireElement("commandList",r);if(e.ensureTerminated(I),r.matchToken("catch")&&(N=r.requireTokenType("IDENTIFIER").value,w=e.requireElement("commandList",r),e.ensureTerminated(w)),r.matchToken("finally")){var C=e.requireElement("commandList",r);e.ensureTerminated(C)}var R={displayName:a,events:i,start:I,every:n,execCount:0,errorHandler:w,errorSymbol:N,execute:function(e){let r=t.getEventQueueFor(e.me,R);if(r.executing&&!1===n){if(q||S&&r.queue.length>0)return;return b&&(r.queue.length=0),void r.queue.push(e)}R.execCount++,r.executing=!0,e.meta.onHalt=function(){r.executing=!1;var e=r.queue.shift();e&&setTimeout((function(){R.execute(e)}),1)},e.meta.reject=function(r){console.error(r.message?r.message:r);var n=t.getHyperTrace(e,r);n&&n.print(),t.triggerEvent(e.me,"exception",{error:r})},I.execute(e)},install:function(e,r){for(const r of R.events){var n;n=r.elsewhere?[document]:r.from?r.from.evaluate(t.makeContext(e,R,e,null)):[e],t.implicitLoop(n,(function(n){var i=r.on;if(null!=n){if(r.mutationSpec){i="hyperscript:mutation";const e=new MutationObserver((function(e,r){R.executing||t.triggerEvent(n,i,{mutationList:e,observer:r})}));e.observe(n,r.mutationSpec)}if(r.intersectionSpec){i="hyperscript:intersection";const e=new IntersectionObserver((function(r){for(const o of r){var a={observer:e};(a=Object.assign(a,o)).intersecting=o.isIntersecting,t.triggerEvent(n,i,a)}}),r.intersectionSpec);e.observe(n)}(n.addEventListener||n.on).call(n,i,(function a(o){if("undefined"!=typeof Node&&e instanceof Node&&n!==e&&!e.isConnected)n.removeEventListener(i,a);else{var s=t.makeContext(e,R,e,o);if(!r.elsewhere||!e.contains(o.target)){r.from&&(s.result=n);for(const e of r.args){let t=s.event[e.value];void 0!==t?s.locals[e.value]=t:"detail"in s.event&&(s.locals[e.value]=s.event.detail[e.value])}if(s.meta.errorHandler=w,s.meta.errorSymbol=N,s.meta.finallyHandler=C,r.filter){var u=s.meta.context;s.meta.context=s.event;try{if(!r.filter.evaluate(s))return}finally{s.meta.context=u}}if(r.inExpr)for(var l=o.target;;){if(l.matches&&l.matches(r.inExpr.css)){s.result=l;break}if(null==(l=l.parentElement))return}if(r.execCount++,r.startCount)if(r.endCount){if(r.execCount<r.startCount||r.execCount>r.endCount)return}else if(r.unbounded){if(r.execCount<r.startCount)return}else if(r.execCount!==r.startCount)return;if(r.debounceTime)return r.debounced&&clearTimeout(r.debounced),void(r.debounced=setTimeout((function(){R.execute(s)}),r.debounceTime));if(r.throttleTime){if(r.lastExec&&Date.now()<r.lastExec+r.throttleTime)return;r.lastExec=Date.now()}R.execute(s)}}}))}else console.warn("'%s' feature ignored because target does not exists:",a,e)}))}}};return e.setParent(I,R),R}})),t.addFeature("def",(function(e,t,r){if(r.matchToken("def")){var n=e.requireElement("dotOrColonPath",r).evaluate(),i=n.split("."),a=i.pop(),o=[];if(r.matchOpToken("("))if(r.matchOpToken(")"));else{do{o.push(r.requireTokenType("IDENTIFIER"))}while(r.matchOpToken(","));r.requireOpToken(")")}var s,u,l=e.requireElement("commandList",r);if(r.matchToken("catch")&&(s=r.requireTokenType("IDENTIFIER").value,u=e.parseElement("commandList",r)),r.matchToken("finally")){var c=e.requireElement("commandList",r);e.ensureTerminated(c)}var m={displayName:a+"("+o.map((function(e){return e.value})).join(", ")+")",name:a,args:o,start:l,errorHandler:u,errorSymbol:s,finallyHandler:c,install:function(e,r){var f=function(){var n=t.makeContext(r,m,e,null);n.meta.errorHandler=u,n.meta.errorSymbol=s,n.meta.finallyHandler=c;for(var i=0;i<o.length;i++){var a=o[i],f=arguments[i];a&&(n.locals[a.value]=f)}n.meta.caller=arguments[o.length],n.meta.caller&&(n.meta.callingCommand=n.meta.caller.meta.command);var p,h=null,d=new Promise((function(e,t){p=e,h=t}));return l.execute(n),n.meta.returned?n.meta.returnValue:(n.meta.resolve=p,n.meta.reject=h,d)};f.hyperfunc=!0,f.hypername=n,t.assignToNamespace(e,i,a,f)}};return e.ensureTerminated(l),u&&e.ensureTerminated(u),e.setParent(l,m),m}})),t.addFeature("set",(function(e,t,r){let n=e.parseElement("setCommand",r);if(n){"element"!==n.target.scope&&e.raiseParseError(r,"variables declared at the feature level must be element scoped.");let i={start:n,install:function(e,r){n&&n.execute(t.makeContext(e,i,e,null))}};return e.ensureTerminated(n),i}})),t.addFeature("init",(function(e,t,r){if(r.matchToken("init")){var n=r.matchToken("immediately"),i=e.requireElement("commandList",r),a={start:i,install:function(e,r){let o=function(){i&&i.execute(t.makeContext(e,a,e,null))};n?o():setTimeout(o,0)}};return e.ensureTerminated(i),e.setParent(i,a),a}})),t.addFeature("worker",(function(e,t,r){r.matchToken("worker")&&e.raiseParseError(r,"In order to use the 'worker' feature, include the _hyperscript worker plugin. See https://hyperscript.org/features/worker/ for more info.")})),t.addFeature("behavior",(function(t,r,n){if(n.matchToken("behavior")){var i=t.requireElement("dotOrColonPath",n).evaluate(),a=i.split("."),o=a.pop(),s=[];if(n.matchOpToken("(")&&!n.matchOpToken(")")){do{s.push(n.requireTokenType("IDENTIFIER").value)}while(n.matchOpToken(","));n.requireOpToken(")")}for(var u=t.requireElement("hyperscript",n),l=0;l<u.features.length;l++){u.features[l].behavior=i}return{install:function(t,n){r.assignToNamespace(e.document&&e.document.body,a,o,(function(e,t,n){for(var a=c(r.getInternalData(e),i+"Scope"),o=0;o<s.length;o++)a[s[o]]=n[s[o]];u.apply(e,t)}))}}}})),t.addFeature("install",(function(t,r,n){if(n.matchToken("install")){var i,a=t.requireElement("dotOrColonPath",n).evaluate(),o=a.split("."),s=t.parseElement("namedArgumentList",n);return i={install:function(t,n){r.unifiedEval({args:[s],op:function(r,i){for(var s=e,u=0;u<o.length;u++)if("object"!=typeof(s=s[o[u]])&&"function"!=typeof s)throw new Error("No such behavior defined as "+a);if(!(s instanceof Function))throw new Error(a+" is not a behavior");s(t,n,i)}},r.makeContext(t,i,t,null))}}}})),t.addGrammarElement("jsBody",(function(e,t,r){for(var n=r.currentToken().start,i=r.currentToken(),a=[],o="",s=!1;r.hasMore();){i=r.consumeToken();var u=r.token(0,!0);if("IDENTIFIER"===u.type&&"end"===u.value)break;s?"IDENTIFIER"===i.type||"NUMBER"===i.type?o+=i.value:(""!==o&&a.push(o),o="",s=!1):"IDENTIFIER"===i.type&&"function"===i.value&&(s=!0)}var l=i.end+1;return{type:"jsBody",exposedFunctionNames:a,jsSource:r.source.substring(n,l)}})),t.addFeature("js",(function(t,r,n){if(n.matchToken("js")){var i=t.requireElement("jsBody",n),a=i.jsSource+"\nreturn { "+i.exposedFunctionNames.map((function(e){return e+":"+e})).join(",")+" } ",o=new Function(a);return{jsSource:a,function:o,exposedFunctionNames:i.exposedFunctionNames,install:function(){Object.assign(e,o())}}}})),t.addCommand("js",(function(t,r,n){if(n.matchToken("js")){var i=[];if(n.matchOpToken("("))if(n.matchOpToken(")"));else{do{var a=n.requireTokenType("IDENTIFIER");i.push(a.value)}while(n.matchOpToken(","));n.requireOpToken(")")}var o=t.requireElement("jsBody",n);n.matchToken("end");var s=f(Function,i.concat([o.jsSource])),u={jsSource:o.jsSource,function:s,inputs:i,op:function(t){var n=[];i.forEach((function(e){n.push(r.resolveSymbol(e,t,"default"))}));var a=s.apply(e,n);return a&&"function"==typeof a.then?new Promise((function(e){a.then((function(n){t.result=n,e(r.findNext(this,t))}))})):(t.result=a,r.findNext(this,t))}};return u}})),t.addCommand("async",(function(e,t,r){if(r.matchToken("async")){if(r.matchToken("do")){for(var n=i=e.requireElement("commandList",r);n.next;)n=n.next;n.next=t.HALT,r.requireToken("end")}else var i=e.requireElement("command",r);var a={body:i,op:function(e){return setTimeout((function(){i.execute(e)})),t.findNext(this,e)}};return e.setParent(i,a),a}})),t.addCommand("tell",(function(e,t,r){var n=r.currentToken();if(r.matchToken("tell")){var i=e.requireElement("expression",r),a=e.requireElement("commandList",r);r.hasMore()&&!e.featureStart(r.currentToken())&&r.requireToken("end");var o="tell_"+n.start,s={value:i,body:a,args:[i],resolveNext:function(e){var r=e.meta.iterators[o];return r.index<r.value.length?(e.you=r.value[r.index++],a):(e.you=r.originalYou,this.next?this.next:t.findNext(this.parent,e))},op:function(e,t){return null==t?t=[]:Array.isArray(t)||t instanceof NodeList||(t=[t]),e.meta.iterators[o]={originalYou:e.you,index:0,value:t},this.resolveNext(e)}};return e.setParent(a,s),s}})),t.addCommand("wait",(function(e,t,r){if(r.matchToken("wait")){var n,i;if(r.matchToken("for")){r.matchToken("a");var a=[];do{var o=r.token(0);"NUMBER"===o.type||"L_PAREN"===o.type?a.push({time:e.requireElement("expression",r).evaluate()}):a.push({name:e.requireElement("dotOrColonPath",r,"Expected event name").evaluate(),args:p(r)})}while(r.matchToken("or"));if(r.matchToken("from"))var s=e.requireElement("expression",r);return n={event:a,on:s,args:[s],op:function(e,r){var n=r||e.me;if(!(n instanceof EventTarget))throw new Error("Not a valid event target: "+this.on.sourceFor());return new Promise((r=>{var i=!1;for(const s of a){var o=n=>{if(e.result=n,s.args)for(const t of s.args)e.locals[t.value]=n[t.value]||(n.detail?n.detail[t.value]:null);i||(i=!0,r(t.findNext(this,e)))};s.name?n.addEventListener(s.name,o,{once:!0}):null!=s.time&&setTimeout(o,s.time,s.time)}}))}},n}return r.matchToken("a")?(r.requireToken("tick"),i=0):i=e.requireElement("expression",r),n={type:"waitCmd",time:i,args:[i],op:function(e,r){return new Promise((n=>{setTimeout((()=>{n(t.findNext(this,e))}),r)}))},execute:function(e){return t.unifiedExec(this,e)}},n}})),t.addGrammarElement("dotOrColonPath",(function(e,t,r){var n=r.matchTokenType("IDENTIFIER");if(n){var i=[n.value],a=r.matchOpToken(".")||r.matchOpToken(":");if(a)do{i.push(r.requireTokenType("IDENTIFIER","NUMBER").value)}while(r.matchOpToken(a.value));return{type:"dotOrColonPath",path:i,evaluate:function(){return i.join(a?a.value:"")}}}})),t.addGrammarElement("eventName",(function(e,t,r){var n;return(n=r.matchTokenType("STRING"))?{evaluate:function(){return n.value}}:e.parseElement("dotOrColonPath",r)})),t.addCommand("trigger",(function(e,t,r){if(r.matchToken("trigger"))return h("trigger",e,t,r)})),t.addCommand("send",(function(e,t,r){if(r.matchToken("send"))return h("send",e,t,r)}));var d=function(e,t,r,n){if(n)if(e.commandBoundary(r.currentToken()))e.raiseParseError(r,"'return' commands must return a value.  If you do not wish to return a value, use 'exit' instead.");else var i=e.requireElement("expression",r);var a={value:i,args:[i],op:function(e,r){var n=e.meta.resolve;return e.meta.returned=!0,e.meta.returnValue=r,n&&(r?n(r):n()),t.HALT}};return a};t.addCommand("return",(function(e,t,r){if(r.matchToken("return"))return d(e,t,r,!0)})),t.addCommand("exit",(function(e,t,r){if(r.matchToken("exit"))return d(e,t,r,!1)})),t.addCommand("halt",(function(e,t,r){if(r.matchToken("halt")){if(r.matchToken("the")){r.requireToken("event"),r.matchOpToken("'")&&r.requireToken("s");var n=!0}if(r.matchToken("bubbling"))var i=!0;else if(r.matchToken("default"))var a=!0;var o=d(e,t,r,!1),s={keepExecuting:!0,bubbling:i,haltDefault:a,exit:o,op:function(e){if(e.event)return i?e.event.stopPropagation():(a||e.event.stopPropagation(),e.event.preventDefault()),n?t.findNext(this,e):o}};return s}})),t.addCommand("log",(function(e,t,r){if(r.matchToken("log")){for(var n=[e.parseElement("expression",r)];r.matchOpToken(",");)n.push(e.requireElement("expression",r));if(r.matchToken("with"))var i=e.requireElement("expression",r);var a={exprs:n,withExpr:i,args:[i,n],op:function(e,r,n){return r?r.apply(null,n):console.log.apply(null,n),t.findNext(this,e)}};return a}})),t.addCommand("throw",(function(e,t,r){if(r.matchToken("throw")){var n=e.requireElement("expression",r),i={expr:n,args:[n],op:function(e,r){throw t.registerHyperTrace(e,r),r}};return i}}));var v=function(e,t,r){var n=e.requireElement("expression",r),i={expr:n,args:[n],op:function(e,r){return e.result=r,t.findNext(i,e)}};return i};t.addCommand("call",(function(e,t,r){if(r.matchToken("call")){var n=v(e,t,r);return n.expr&&"functionCall"!==n.expr.type&&e.raiseParseError(r,"Must be a function invocation"),n}})),t.addCommand("get",(function(e,t,r){if(r.matchToken("get"))return v(e,t,r)})),t.addCommand("make",(function(e,t,r){if(r.matchToken("make")){r.matchToken("a")||r.matchToken("an");var n,i=e.requireElement("expression",r),a=[];if("queryRef"!==i.type&&r.matchToken("from"))do{a.push(e.requireElement("expression",r))}while(r.matchOpToken(","));if(r.matchToken("called"))var o=e.requireElement("symbol",r);return"queryRef"===i.type?(n={op:function(e){for(var r,n,a="div",s=[],u=/(?:(^|#|\.)([^#\. ]+))/g;r=u.exec(i.css);)""===r[1]?a=r[2].trim():"#"===r[1]?n=r[2].trim():s.push(r[2].trim());var l=document.createElement(a);void 0!==n&&(l.id=n);for(var c=0;c<s.length;c++){var m=s[c];l.classList.add(m)}return e.result=l,o&&t.setSymbol(o.name,e,o.scope,l),t.findNext(this,e)}},n):(n={args:[i,a],op:function(e,r,n){return e.result=f(r,n),o&&t.setSymbol(o.name,e,o.scope,e.result),t.findNext(this,e)}},n)}})),t.addGrammarElement("pseudoCommand",(function(e,t,r){let n=r.token(1);if(!n||!n.op||"."!==n.value&&"("!==n.value)return null;for(var i,a=e.requireElement("primaryExpression",r),o=a.root,s=a;null!=o.root;)s=s.root,o=o.root;if("functionCall"!==a.type&&e.raiseParseError(r,"Pseudo-commands must be function calls"),"functionCall"===s.type&&null==s.root.root)if(r.matchAnyToken("the","to","on","with","into","from","at"))var u=e.requireElement("expression",r);else if(r.matchToken("me"))u=e.requireElement("implicitMeTarget",r);return i=u?{type:"pseudoCommand",root:u,argExressions:s.argExressions,args:[u,s.argExressions],op:function(e,r,n){t.nullCheck(r,u);var a=r[s.root.name];return t.nullCheck(a,s),a.hyperfunc&&n.push(e),e.result=a.apply(r,n),t.findNext(i,e)},execute:function(e){return t.unifiedExec(this,e)}}:{type:"pseudoCommand",expr:a,args:[a],op:function(e,r){return e.result=r,t.findNext(i,e)},execute:function(e){return t.unifiedExec(this,e)}},i}));var E=function(e,t,r,n,i){var a="symbol"===n.type,o="attributeRef"===n.type,s="styleRef"===n.type,u="arrayIndex"===n.type;o||s||a||null!=n.root||e.raiseParseError(r,"Can only put directly into symbols, not references");var l=null,c=null;if(a);else if(o||s){l=e.requireElement("implicitMeTarget",r);var m=n}else if(u)c=n.firstIndex,l=n.root;else{c=n.prop?n.prop.value:null;m=n.attribute;l=n.root}var f={target:n,symbolWrite:a,value:i,args:[l,c,i],op:function(e,r,i,o){return a?t.setSymbol(n.name,e,n.scope,o):(t.nullCheck(r,l),u?r[i]=o:t.implicitLoop(r,(function(e){m?"attributeRef"===m.type?null==o?e.removeAttribute(m.name):e.setAttribute(m.name,o):e.style[m.name]=o:e[i]=o}))),t.findNext(this,e)}};return f};t.addCommand("default",(function(e,t,r){if(r.matchToken("default")){var n=e.requireElement("assignableExpression",r);r.requireToken("to");var i=e.requireElement("expression",r),a=E(e,t,r,n,i),o={target:n,value:i,setter:a,args:[n],op:function(e,r){return r?t.findNext(this,e):a}};return a.parent=o,o}})),t.addCommand("set",(function(e,t,r){if(r.matchToken("set")){if("L_BRACE"===r.currentToken().type){var n=e.requireElement("objectLiteral",r);r.requireToken("on");var i={objectLiteral:n,target:a=e.requireElement("expression",r),args:[n,a],op:function(e,r,n){return Object.assign(n,r),t.findNext(this,e)}};return i}try{r.pushFollow("to");var a=e.requireElement("assignableExpression",r)}finally{r.popFollow()}r.requireToken("to");var o=e.requireElement("expression",r);return E(e,t,r,a,o)}})),t.addCommand("if",(function(e,t,r){if(r.matchToken("if")){var n=e.requireElement("expression",r);r.matchToken("then");var i=e.parseElement("commandList",r),a=!1;if(r.matchToken("else")||r.matchToken("otherwise")){a=r.peekToken("if");var o=e.parseElement("commandList",r)}r.hasMore()&&!a&&r.requireToken("end");var s={expr:n,trueBranch:i,falseBranch:o,args:[n],op:function(e,r){return r?i:o||t.findNext(this,e)}};return e.setParent(i,s),e.setParent(o,s),s}}));var T=function(e,t,r,n){var i,a=t.currentToken();if(t.matchToken("for")||n){var o=t.requireTokenType("IDENTIFIER");i=o.value,t.requireToken("in");var s=e.requireElement("expression",t)}else if(t.matchToken("in")){i="it";s=e.requireElement("expression",t)}else if(t.matchToken("while"))var u=e.requireElement("expression",t);else if(t.matchToken("until")){var l=!0;if(t.matchToken("event")){var c=e.requireElement("dotOrColonPath",t,"Expected event name");if(t.matchToken("from"))var m=e.requireElement("expression",t)}else u=e.requireElement("expression",t)}else if(e.commandBoundary(t.currentToken())||"forever"===t.currentToken().value){t.matchToken("forever");var f=!0}else{var p=e.requireElement("expression",t);t.requireToken("times")}if(t.matchToken("index"))var h=(o=t.requireTokenType("IDENTIFIER")).value;var d=e.parseElement("commandList",t);if(d&&c){for(var v=d;v.next;)v=v.next;var E={type:"waitATick",op:function(){return new Promise((function(e){setTimeout((function(){e(r.findNext(E))}),0)}))}};v.next=E}if(t.hasMore()&&t.requireToken("end"),null==i)var T=i="_implicit_repeat_"+a.start;else T=i+"_"+a.start;var y={identifier:i,indexIdentifier:h,slot:T,expression:s,forever:f,times:p,until:l,event:c,on:m,whileExpr:u,resolveNext:function(){return this},loop:d,args:[u,p],op:function(e,t,n){var a=e.meta.iterators[T],o=!1,s=null;if(this.forever)o=!0;else if(this.until)o=c?!1===e.meta.iterators[T].eventFired:!0!==t;else if(u)o=t;else if(n)o=a.index<n;else{var l=a.iterator.next();o=!l.done,s=l.value}return o?(a.value?e.result=e.locals[i]=s:e.result=a.index,h&&(e.locals[h]=a.index),a.index++,d):(e.meta.iterators[T]=null,r.findNext(this.parent,e))}};e.setParent(d,y);var k={name:"repeatInit",args:[s,c,m],op:function(e,t,r,n){var i={index:0,value:t,eventFired:!1};(e.meta.iterators[T]=i,t&&t[Symbol.iterator]&&(i.iterator=t[Symbol.iterator]()),c)&&(n||e.me).addEventListener(r,(function(t){e.meta.iterators[T].eventFired=!0}),{once:!0});return y},execute:function(e){return r.unifiedExec(this,e)}};return e.setParent(y,k),k};t.addCommand("repeat",(function(e,t,r){if(r.matchToken("repeat"))return T(e,r,t,!1)})),t.addCommand("for",(function(e,t,r){if(r.matchToken("for"))return T(e,r,t,!0)})),t.addCommand("continue",(function(e,t,r){if(r.matchToken("continue")){var n={op:function(t){for(var n=this.parent;;n=n.parent)if(null==n&&e.raiseParseError(r,"Command `continue` cannot be used outside of a `repeat` loop."),null!=n.loop)return n.resolveNext(t)}};return n}})),t.addCommand("break",(function(e,t,r){if(r.matchToken("break")){var n={op:function(n){for(var i=this.parent;;i=i.parent)if(null==i&&e.raiseParseError(r,"Command `continue` cannot be used outside of a `repeat` loop."),null!=i.loop)return t.findNext(i.parent,n)}};return n}})),t.addGrammarElement("stringLike",(function(e,t,r){return e.parseAnyOf(["string","nakedString"],r)})),t.addCommand("append",(function(e,t,r){if(r.matchToken("append")){var n=null,i=e.requireElement("expression",r),a={type:"symbol",evaluate:function(e){return t.resolveSymbol("result",e)}};n=r.matchToken("to")?e.requireElement("expression",r):a;var o=null;"symbol"!==n.type&&"attributeRef"!==n.type&&null==n.root||(o=E(e,t,r,n,a));var s={value:i,target:n,args:[n,i],op:function(e,r,n){if(Array.isArray(r))return r.push(n),t.findNext(this,e);if(r instanceof Element)return r.innerHTML+=n,t.findNext(this,e);if(o)return e.result=(r||"")+n,o;throw Error("Unable to append a value!")},execute:function(e){return t.unifiedExec(this,e)}};return null!=o&&(o.parent=s),s}}));class y{constructor(e,t){this.re=e,this.str=t}next(){const e=this.re.exec(this.str);return null===e?{done:!0}:{value:e}}}class k{constructor(e,t,r){this.re=e,this.flags=t,this.str=r}[Symbol.iterator](){return new y(new RegExp(this.re,this.flags),this.str)}}function x(e,t){var r,n="text";return e.matchToken("a")||e.matchToken("an"),e.matchToken("json")||e.matchToken("Object")?n="json":e.matchToken("response")?n="response":e.matchToken("html")?n="html":e.matchToken("text")||(r=t.requireElement("dotOrColonPath",e).evaluate()),{type:n,conversion:r}}t.addCommand("pick",((e,t,r)=>{if(r.matchToken("pick")){if(r.matchToken("the"),r.matchToken("item")||r.matchToken("items")||r.matchToken("character")||r.matchToken("characters")){const n=function(e,t,r){r.matchToken("at")||r.matchToken("from");const n={includeStart:!0,includeEnd:!1};return n.from=r.matchToken("start")?0:e.requireElement("expression",r),(r.matchToken("to")||r.matchOpToken(".."))&&(r.matchToken("end")?n.toEnd=!0:n.to=e.requireElement("expression",r)),r.matchToken("inclusive")?n.includeEnd=!0:r.matchToken("exclusive")&&(n.includeStart=!1),n}(e,0,r);r.requireToken("from");return{args:[e.requireElement("expression",r),n.from,n.to],op(e,r,i,a){return n.toEnd&&(a=r.length),n.includeStart||i++,n.includeEnd&&a++,null!=a&&null!=a||(a=i+1),e.result=r.slice(i,a),t.findNext(this,e)}}}if(r.matchToken("match")){r.matchToken("of");const n=e.parseElement("expression",r);let i="";r.matchOpToken("|")&&(i=r.requireToken("identifier").value),r.requireToken("from");return{args:[e.parseElement("expression",r),n],op(e,r,n){return e.result=new RegExp(n,i).exec(r),t.findNext(this,e)}}}if(r.matchToken("matches")){r.matchToken("of");const n=e.parseElement("expression",r);let i="gu";r.matchOpToken("|")&&(i="g"+r.requireToken("identifier").value.replace("g","")),console.log("flags",i),r.requireToken("from");return{args:[e.parseElement("expression",r),n],op(e,r,n){return e.result=new k(n,i,r),t.findNext(this,e)}}}}})),t.addCommand("increment",(function(e,t,r){if(r.matchToken("increment")){var n,i=e.parseElement("assignableExpression",r);r.matchToken("by")&&(n=e.requireElement("expression",r));var a={type:"implicitIncrementOp",target:i,args:[i,n],op:function(e,t,r){var i=(t=t?parseFloat(t):0)+(r=n?parseFloat(r):1);return e.result=i,i},evaluate:function(e){return t.unifiedEval(this,e)}};return E(e,t,r,i,a)}})),t.addCommand("decrement",(function(e,t,r){if(r.matchToken("decrement")){var n,i=e.parseElement("assignableExpression",r);r.matchToken("by")&&(n=e.requireElement("expression",r));var a={type:"implicitDecrementOp",target:i,args:[i,n],op:function(e,t,r){var i=(t=t?parseFloat(t):0)-(r=n?parseFloat(r):1);return e.result=i,i},evaluate:function(e){return t.unifiedEval(this,e)}};return E(e,t,r,i,a)}})),t.addCommand("fetch",(function(e,t,r){if(r.matchToken("fetch")){var n=e.requireElement("stringLike",r);if(r.matchToken("as"))var i=x(r,e);if(r.matchToken("with")&&"{"!==r.currentToken().value)var a=e.parseElement("nakedNamedArgumentList",r);else a=e.parseElement("objectLiteral",r);null==i&&r.matchToken("as")&&(i=x(r,e));var o=i?i.type:"text",s=i?i.conversion:null,u={url:n,argExpressions:a,args:[n,a],op:function(e,r,n){var i=n||{};i.sender=e.me,i.headers=i.headers||{};var a=new AbortController;let l=e.me.addEventListener("fetch:abort",(function(){a.abort()}),{once:!0});i.signal=a.signal,t.triggerEvent(e.me,"hyperscript:beforeFetch",i),t.triggerEvent(e.me,"fetch:beforeRequest",i);var c=!1;return(n=i).timeout&&setTimeout((function(){c||a.abort()}),n.timeout),fetch(r,n).then((function(r){let n={response:r};return t.triggerEvent(e.me,"fetch:afterResponse",n),r=n.response,"response"===o?(e.result=r,t.triggerEvent(e.me,"fetch:afterRequest",{result:r}),c=!0,t.findNext(u,e)):"json"===o?r.json().then((function(r){return e.result=r,t.triggerEvent(e.me,"fetch:afterRequest",{result:r}),c=!0,t.findNext(u,e)})):r.text().then((function(r){return s&&(r=t.convertValue(r,s)),"html"===o&&(r=t.convertValue(r,"Fragment")),e.result=r,t.triggerEvent(e.me,"fetch:afterRequest",{result:r}),c=!0,t.findNext(u,e)}))})).catch((function(r){throw t.triggerEvent(e.me,"fetch:error",{reason:r}),r})).finally((function(){e.me.removeEventListener("fetch:abort",l)}))}};return u}}))}function h(e){e.addCommand("settle",(function(e,t,r){if(r.matchToken("settle")){if(e.commandBoundary(r.currentToken()))n=e.requireElement("implicitMeTarget",r);else var n=e.requireElement("expression",r);var i={type:"settleCmd",args:[n],op:function(e,r){t.nullCheck(r,n);var a=null,o=!1,s=new Promise((function(e){a=e}));return r.addEventListener("transitionstart",(function(){o=!0}),{once:!0}),setTimeout((function(){o||a(t.findNext(i,e))}),500),r.addEventListener("transitionend",(function(){a(t.findNext(i,e))}),{once:!0}),s},execute:function(e){return t.unifiedExec(this,e)}};return i}})),e.addCommand("add",(function(e,t,r){if(r.matchToken("add")){var n=e.parseElement("classRef",r),i=null,a=null;if(null==n)null==(i=e.parseElement("attributeRef",r))&&null==(a=e.parseElement("styleLiteral",r))&&e.raiseParseError(r,"Expected either a class reference or attribute expression");else for(var o=[n];n=e.parseElement("classRef",r);)o.push(n);if(r.matchToken("to"))var s=e.requireElement("expression",r);else s=e.requireElement("implicitMeTarget",r);if(r.matchToken("when")){a&&e.raiseParseError(r,"Only class and properties are supported with a when clause");var u=e.requireElement("expression",r)}return o?{classRefs:o,to:s,args:[s,o],op:function(e,r,n){return t.nullCheck(r,s),t.forEach(n,(function(n){t.implicitLoop(r,(function(r){if(u){e.result=r,t.evaluateNoPromise(u,e)?r instanceof Element&&r.classList.add(n.className):r instanceof Element&&r.classList.remove(n.className),e.result=null}else r instanceof Element&&r.classList.add(n.className)}))})),t.findNext(this,e)}}:i?{type:"addCmd",attributeRef:i,to:s,args:[s],op:function(e,r,n){return t.nullCheck(r,s),t.implicitLoop(r,(function(r){if(u){e.result=r,t.evaluateNoPromise(u,e)?r.setAttribute(i.name,i.value):r.removeAttribute(i.name),e.result=null}else r.setAttribute(i.name,i.value)})),t.findNext(this,e)},execute:function(e){return t.unifiedExec(this,e)}}:{type:"addCmd",cssDeclaration:a,to:s,args:[s,a],op:function(e,r,n){return t.nullCheck(r,s),t.implicitLoop(r,(function(e){e.style.cssText+=n})),t.findNext(this,e)},execute:function(e){return t.unifiedExec(this,e)}}}})),e.addGrammarElement("styleLiteral",(function(e,t,r){if(r.matchOpToken("{")){for(var n=[""],i=[];r.hasMore();){if(r.matchOpToken("\\"))r.consumeToken();else{if(r.matchOpToken("}"))break;if(r.matchToken("$")){var a=r.matchOpToken("{"),o=e.parseElement("expression",r);a&&r.requireOpToken("}"),i.push(o),n.push("")}else{var s=r.consumeToken();n[n.length-1]+=r.source.substring(s.start,s.end)}}n[n.length-1]+=r.lastWhitespace()}return{type:"styleLiteral",args:[i],op:function(e,t){var r="";return n.forEach((function(e,n){r+=e,n in t&&(r+=t[n])})),r},evaluate:function(e){return t.unifiedEval(this,e)}}}})),e.addCommand("remove",(function(e,t,r){if(r.matchToken("remove")){var n=e.parseElement("classRef",r),i=null,a=null;if(null==n)null==(i=e.parseElement("attributeRef",r))&&null==(a=e.parseElement("expression",r))&&e.raiseParseError(r,"Expected either a class reference, attribute expression or value expression");else for(var o=[n];n=e.parseElement("classRef",r);)o.push(n);if(r.matchToken("from"))var s=e.requireElement("expression",r);else if(null==a)s=e.requireElement("implicitMeTarget",r);return a?{elementExpr:a,from:s,args:[a,s],op:function(e,r,n){return t.nullCheck(r,a),t.implicitLoop(r,(function(e){e.parentElement&&(null==n||n.contains(e))&&e.parentElement.removeChild(e)})),t.findNext(this,e)}}:{classRefs:o,attributeRef:i,elementExpr:a,from:s,args:[o,s],op:function(e,r,n){return t.nullCheck(n,s),r?t.forEach(r,(function(e){t.implicitLoop(n,(function(t){t.classList.remove(e.className)}))})):t.implicitLoop(n,(function(e){e.removeAttribute(i.name)})),t.findNext(this,e)}}}})),e.addCommand("toggle",(function(e,t,r){if(r.matchToken("toggle")){if(r.matchAnyToken("the","my"),"STYLE_REF"===r.currentToken().type){var n=r.consumeToken().value.substr(1),a=!0,o=i(e,r,n);if(r.matchToken("of")){r.pushFollow("with");try{var s=e.requireElement("expression",r)}finally{r.popFollow()}}else s=e.requireElement("implicitMeTarget",r)}else if(r.matchToken("between")){var u=!0,l=e.parseElement("classRef",r);r.requireToken("and");var c=e.requireElement("classRef",r)}else{l=e.parseElement("classRef",r);var m=null;if(null==l)null==(m=e.parseElement("attributeRef",r))&&e.raiseParseError(r,"Expected either a class reference or attribute expression");else for(var f=[l];l=e.parseElement("classRef",r);)f.push(l)}if(!0!==a)if(r.matchToken("on"))s=e.requireElement("expression",r);else s=e.requireElement("implicitMeTarget",r);if(r.matchToken("for"))var p=e.requireElement("expression",r);else if(r.matchToken("until")){var h=e.requireElement("dotOrColonPath",r,"Expected event name");if(r.matchToken("from"))var d=e.requireElement("expression",r)}var v={classRef:l,classRef2:c,classRefs:f,attributeRef:m,on:s,time:p,evt:h,from:d,toggle:function(e,r,n,i){t.nullCheck(e,s),a?t.implicitLoop(e,(function(e){o("toggle",e)})):u?t.implicitLoop(e,(function(e){e.classList.contains(r.className)?(e.classList.remove(r.className),e.classList.add(n.className)):(e.classList.add(r.className),e.classList.remove(n.className))})):i?t.forEach(i,(function(r){t.implicitLoop(e,(function(e){e.classList.toggle(r.className)}))})):t.forEach(e,(function(e){e.hasAttribute(m.name)?e.removeAttribute(m.name):e.setAttribute(m.name,m.value)}))},args:[s,p,h,d,l,c,f],op:function(e,r,n,i,a,o,s,u){return n?new Promise((function(i){v.toggle(r,o,s,u),setTimeout((function(){v.toggle(r,o,s,u),i(t.findNext(v,e))}),n)})):i?new Promise((function(n){(a||e.me).addEventListener(i,(function(){v.toggle(r,o,s,u),n(t.findNext(v,e))}),{once:!0}),v.toggle(r,o,s,u)})):(this.toggle(r,o,s,u),t.findNext(v,e))}};return v}}));var t={display:function(r,n,i){if(i)n.style.display=i;else if("toggle"===r)"none"===getComputedStyle(n).display?t.display("show",n,i):t.display("hide",n,i);else if("hide"===r){const t=e.runtime.getInternalData(n);null==t.originalDisplay&&(t.originalDisplay=n.style.display),n.style.display="none"}else{const t=e.runtime.getInternalData(n);t.originalDisplay&&"none"!==t.originalDisplay?n.style.display=t.originalDisplay:n.style.removeProperty("display")}},visibility:function(e,r,n){n?r.style.visibility=n:"toggle"===e?"hidden"===getComputedStyle(r).visibility?t.visibility("show",r,n):t.visibility("hide",r,n):r.style.visibility="hide"===e?"hidden":"visible"},opacity:function(e,r,n){n?r.style.opacity=n:"toggle"===e?"0"===getComputedStyle(r).opacity?t.opacity("show",r,n):t.opacity("hide",r,n):r.style.opacity="hide"===e?"0":"1"}},n=function(e,t,r){var n=r.currentToken();return"when"===n.value||"with"===n.value||e.commandBoundary(n)?e.parseElement("implicitMeTarget",r):e.parseElement("expression",r)},i=function(e,n,i){var a=r.defaultHideShowStrategy,o=t;r.hideShowStrategies&&(o=Object.assign(o,r.hideShowStrategies));var s=o[i=i||a||"display"];return null==s&&e.raiseParseError(n,"Unknown show/hide strategy : "+i),s};function a(t,r,n,i){if(null!=n)var a=t.resolveSymbol(n,r);else a=r;if(a instanceof Element||a instanceof HTMLDocument){for(;a.firstChild;)a.removeChild(a.firstChild);a.append(e.runtime.convertValue(i,"Fragment")),t.processNode(a)}else{if(null==n)throw"Don't know how to put a value into "+typeof r;t.setSymbol(n,r,null,i)}}function o(e,t,r){var n;if(r.matchToken("the")||r.matchToken("element")||r.matchToken("elements")||"CLASS_REF"===r.currentToken().type||"ID_REF"===r.currentToken().type||r.currentToken().op&&"<"===r.currentToken().value){e.possessivesDisabled=!0;try{n=e.parseElement("expression",r)}finally{delete e.possessivesDisabled}r.matchOpToken("'")&&r.requireToken("s")}else if("IDENTIFIER"===r.currentToken().type&&"its"===r.currentToken().value){var i=r.matchToken("its");n={type:"pseudopossessiveIts",token:i,name:i.value,evaluate:function(e){return t.resolveSymbol("it",e)}}}else r.matchToken("my")||r.matchToken("me"),n=e.parseElement("implicitMeTarget",r);return n}e.addCommand("hide",(function(e,t,r){if(r.matchToken("hide")){var a=n(e,0,r),o=null;r.matchToken("with")&&0===(o=r.requireTokenType("IDENTIFIER","STYLE_REF").value).indexOf("*")&&(o=o.substr(1));var s=i(e,r,o);return{target:a,args:[a],op:function(e,r){return t.nullCheck(r,a),t.implicitLoop(r,(function(e){s("hide",e)})),t.findNext(this,e)}}}})),e.addCommand("show",(function(e,t,r){if(r.matchToken("show")){var a=n(e,0,r),o=null;r.matchToken("with")&&0===(o=r.requireTokenType("IDENTIFIER","STYLE_REF").value).indexOf("*")&&(o=o.substr(1));var s=null;if(r.matchOpToken(":")){var u=r.consumeUntilWhitespace();r.matchTokenType("WHITESPACE"),s=u.map((function(e){return e.value})).join("")}if(r.matchToken("when"))var l=e.requireElement("expression",r);var c=i(e,r,o);return{target:a,when:l,args:[a],op:function(e,r){return t.nullCheck(r,a),t.implicitLoop(r,(function(r){if(l){e.result=r,t.evaluateNoPromise(l,e)?c("show",r,s):c("hide",r),e.result=null}else c("show",r,s)})),t.findNext(this,e)}}}})),e.addCommand("take",(function(e,t,r){if(r.matchToken("take")){var n=e.requireElement("classRef",r);if(r.matchToken("from"))var i=e.requireElement("expression",r);else i=n;if(r.matchToken("for"))var a=e.requireElement("expression",r);else a=e.requireElement("implicitMeTarget",r);var o={classRef:n,from:i,forElt:a,args:[n,i,a],op:function(e,r,n,o){t.nullCheck(n,i),t.nullCheck(o,a);var s=r.className;return t.implicitLoop(n,(function(e){e.classList.remove(s)})),t.implicitLoop(o,(function(e){e.classList.add(s)})),t.findNext(this,e)}};return o}})),e.addCommand("put",(function(e,t,r){if(r.matchToken("put")){var n=e.requireElement("expression",r),i=r.matchAnyToken("into","before","after");null==i&&r.matchToken("at")&&(r.matchToken("the"),i=r.matchAnyToken("start","end"),r.requireToken("of")),null==i&&e.raiseParseError(r,"Expected one of 'into', 'before', 'at start of', 'at end of', 'after'");var o=e.requireElement("expression",r),s=i.value,u=!1,l=!1,c=null,m=null;if("arrayIndex"===o.type&&"into"===s)u=!0,m=o.prop,c=o.root;else if(o.prop&&o.root&&"into"===s)m=o.prop.value,c=o.root;else if("symbol"===o.type&&"into"===s)l=!0,m=o.name;else if("attributeRef"===o.type&&"into"===s){var f=!0;m=o.name,c=e.requireElement("implicitMeTarget",r)}else if("styleRef"===o.type&&"into"===s){var p=!0;m=o.name,c=e.requireElement("implicitMeTarget",r)}else if(o.attribute&&"into"===s){f="attributeRef"===o.attribute.type,p="styleRef"===o.attribute.type;m=o.attribute.name,c=o.root}else c=o;var h={target:o,operation:s,symbolWrite:l,value:n,args:[c,m,n],op:function(e,r,n,i){if(l)a(t,e,n,i);else if(t.nullCheck(r,c),"into"===s)f?t.implicitLoop(r,(function(e){e.setAttribute(n,i)})):p?t.implicitLoop(r,(function(e){e.style[n]=i})):u?r[n]=i:t.implicitLoop(r,(function(e){a(t,e,n,i)}));else{var o="before"===s?Element.prototype.before:"after"===s?Element.prototype.after:"start"===s?Element.prototype.prepend:Element.prototype.append;t.implicitLoop(r,(function(e){o.call(e,i instanceof Node?i:t.convertValue(i,"Fragment")),e.parentElement?t.processNode(e.parentElement):t.processNode(e)}))}return t.findNext(this,e)}};return h}})),e.addCommand("transition",(function(e,t,n){if(n.matchToken("transition")){for(var i=o(e,t,n),a=[],s=[],u=[],l=n.currentToken();!e.commandBoundary(l)&&"over"!==l.value&&"using"!==l.value;){if("STYLE_REF"===n.currentToken().type){let e=n.consumeToken().value.substr(1);a.push({type:"styleRefValue",evaluate:function(){return e}})}else a.push(e.requireElement("stringLike",n));n.matchToken("from")?s.push(e.requireElement("expression",n)):s.push(null),n.requireToken("to"),n.matchToken("initial")?u.push({type:"initial_literal",evaluate:function(){return"initial"}}):u.push(e.requireElement("expression",n)),l=n.currentToken()}if(n.matchToken("over"))var c=e.requireElement("expression",n);else if(n.matchToken("using"))var m=e.requireElement("expression",n);var f={to:u,args:[i,a,s,u,m,c],op:function(e,n,a,o,s,u,l){t.nullCheck(n,i);var c=[];return t.implicitLoop(n,(function(e){var n=new Promise((function(n,i){var c=e.style.transition;e.style.transition=l?"all "+l+"ms ease-in":u||r.defaultTransition;for(var m=t.getInternalData(e),f=getComputedStyle(e),p={},h=0;h<f.length;h++){var d=f[h],v=f[d];p[d]=v}m.initalStyles||(m.initalStyles=p);for(h=0;h<a.length;h++){var E=a[h],T=o[h];e.style[E]="computed"===T||null==T?p[E]:T}var y=!1,k=!1;e.addEventListener("transitionend",(function(){k||(e.style.transition=c,k=!0,n())}),{once:!0}),e.addEventListener("transitionstart",(function(){y=!0}),{once:!0}),setTimeout((function(){k||y||(e.style.transition=c,k=!0,n())}),100),setTimeout((function(){for(var t=0;t<a.length;t++){var r=a[t],n=s[t];if("initial"===n){var i=m.initalStyles[r];e.style[r]=i}else e.style[r]=n}}),0)}));c.push(n)})),Promise.all(c).then((function(){return t.findNext(f,e)}))}};return f}})),e.addCommand("measure",(function(e,t,r){if(r.matchToken("measure")){var n=o(e,t,r),i=[];if(!e.commandBoundary(r.currentToken()))do{i.push(r.matchTokenType("IDENTIFIER").value)}while(r.matchOpToken(","));return{properties:i,args:[n],op:function(e,r){t.nullCheck(r,n),0 in r&&(r=r[0]);var a=r.getBoundingClientRect(),o={top:r.scrollTop,left:r.scrollLeft,topMax:r.scrollTopMax,leftMax:r.scrollLeftMax,height:r.scrollHeight,width:r.scrollWidth};return e.result={x:a.x,y:a.y,left:a.left,top:a.top,right:a.right,bottom:a.bottom,width:a.width,height:a.height,bounds:a,scrollLeft:o.left,scrollTop:o.top,scrollLeftMax:o.leftMax,scrollTopMax:o.topMax,scrollWidth:o.width,scrollHeight:o.height,scroll:o},t.forEach(i,(function(t){if(!(t in e.result))throw"No such measurement as "+t;e.locals[t]=e.result[t]})),t.findNext(this,e)}}}})),e.addLeafExpression("closestExpr",(function(e,t,r){if(r.matchToken("closest")){if(r.matchToken("parent"))var n=!0;var i=null;if("ATTRIBUTE_REF"===r.currentToken().type){var a=e.requireElement("attributeRefAccess",r,null);i="["+a.attribute.name+"]"}if(null==i){var o=e.requireElement("expression",r);null==o.css?e.raiseParseError(r,"Expected a CSS expression"):i=o.css}if(r.matchToken("to"))var s=e.parseElement("expression",r);else s=e.parseElement("implicitMeTarget",r);var u={type:"closestExpr",parentSearch:n,expr:o,css:i,to:s,args:[s],op:function(e,r){if(null==r)return null;{let e=[];return t.implicitLoop(r,(function(t){n?e.push(t.parentElement?t.parentElement.closest(i):null):e.push(t.closest(i))})),t.shouldAutoIterate(r)?e:e[0]}},evaluate:function(e){return t.unifiedEval(this,e)}};return a?(a.root=u,a.args=[u],a):u}})),e.addCommand("go",(function(e,t,r){if(r.matchToken("go")){if(r.matchToken("back"))var n=!0;else if(r.matchToken("to"),r.matchToken("url")){var i=e.requireElement("stringLike",r),a=!0;if(r.matchToken("in")){r.requireToken("new"),r.requireToken("window");var o=!0}}else{r.matchToken("the");var s=r.matchAnyToken("top","middle","bottom"),u=r.matchAnyToken("left","center","right");(s||u)&&r.requireToken("of");i=e.requireElement("unaryExpression",r);var l=r.matchAnyOpToken("+","-");if(l){r.pushFollow("px");try{var c=e.requireElement("expression",r)}finally{r.popFollow()}}r.matchToken("px");var m=r.matchAnyToken("smoothly","instantly"),f={};s&&("top"===s.value?f.block="start":"bottom"===s.value?f.block="end":"middle"===s.value&&(f.block="center")),u&&("left"===u.value?f.inline="start":"center"===u.value?f.inline="center":"right"===u.value&&(f.inline="end")),m&&("smoothly"===m.value?f.behavior="smooth":"instantly"===m.value&&(f.behavior="instant"))}var p={target:i,args:[i,c],op:function(e,r,i){return n?window.history.back():a?r&&(o?window.open(r):window.location.href=r):t.implicitLoop(r,(function(e){if(e===window&&(e=document.body),l){var t=e.getBoundingClientRect();let n=document.createElement("div");if("-"===l.value)var r=-i;else r=- -i;n.style.position="absolute",n.style.top=t.x+r+"px",n.style.left=t.y+r+"px",n.style.height=t.height+2*r+"px",n.style.width=t.width+2*r+"px",n.style.zIndex=""+Number.MIN_SAFE_INTEGER,n.style.opacity="0",document.body.appendChild(n),setTimeout((function(){document.body.removeChild(n)}),100),e=n}e.scrollIntoView(f)})),t.findNext(p,e)}};return p}})),r.conversions.dynamicResolvers.push((function(t,r){if("Values"===t||0===t.indexOf("Values:")){var n=t.split(":")[1],i={};if(e.runtime.implicitLoop.bind(e.runtime)(r,(function(e){var t=o(e);void 0===t?null!=e.querySelectorAll&&e.querySelectorAll("input,select,textarea").forEach(a):i[t.name]=t.value})),n){if("JSON"===n)return JSON.stringify(i);if("Form"===n)return new URLSearchParams(i).toString();throw"Unknown conversion: "+n}return i}function a(e){var t=o(e);null!=t&&(null!=i[t.name]?Array.isArray(i[t.name])&&Array.isArray(t.value)&&(i[t.name]=[].concat(i[t.name],t.value)):i[t.name]=t.value)}function o(e){try{var t={name:e.name,value:e.value};if(null==t.name||null==t.value)return;if("radio"==e.type&&0==e.checked)return;if("checkbox"==e.type&&(0==e.checked?t.value=void 0:"string"==typeof t.value&&(t.value=[t.value])),"select-multiple"==e.type){var r=e.querySelectorAll("option[selected]");t.value=[];for(var n=0;n<r.length;n++)t.value.push(r[n].value)}return t}catch(e){return}}})),r.conversions.HTML=function(e){var t=function(e){if(e instanceof Array)return e.map((function(e){return t(e)})).join("");if(e instanceof HTMLElement)return e.outerHTML;if(e instanceof NodeList){for(var r="",n=0;n<e.length;n++){var i=e[n];i instanceof HTMLElement&&(r+=i.outerHTML)}return r}return e.toString?e.toString():""};return t(e)},r.conversions.Fragment=function(t){var r=document.createDocumentFragment();return e.runtime.implicitLoop(t,(function(e){if(e instanceof Node)r.append(e);else{var t=document.createElement("template");t.innerHTML=e,r.append(t.content)}})),r}}const d=new o,v=d.lexer,E=d.parser;const T=Object.assign((function(e,t){return d.evaluate(e,t)}),{config:r,use(e){e(T)},internals:{lexer:v,parser:E,runtime:d,Lexer:n,Tokens:i,Parser:a,Runtime:o},ElementCollection:u,addFeature:E.addFeature.bind(E),addCommand:E.addCommand.bind(E),addLeafExpression:E.addLeafExpression.bind(E),addIndirectExpression:E.addIndirectExpression.bind(E),evaluate:d.evaluate.bind(d),parse:d.parse.bind(d),processNode:d.processNode.bind(d),browserInit:function(){var t=Array.from(e.document.querySelectorAll("script[type='text/hyperscript'][src]"));Promise.all(t.map((function(e){return fetch(e.src).then((function(e){return e.text()}))}))).then((e=>e.forEach((e=>T(e))))).then((()=>function(e){"loading"!==document.readyState?setTimeout(e):document.addEventListener("DOMContentLoaded",e)}((function(){!function(){var e=function(){var e=document.querySelector('meta[name="htmx-config"]');return e?m(e.content):null}();e&&Object.assign(r,e)}(),d.processNode(document.documentElement),e.document.addEventListener("htmx:load",(function(e){d.processNode(e.detail.elt)}))}))))}});return T})),window._hyperscript=e,window._hyperscript.browserInit();
//# sourceMappingURL=index.94c7fc48.js.map
